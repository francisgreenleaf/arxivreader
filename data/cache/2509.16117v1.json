{
  "success": true,
  "arxiv_id": "2509.16117v1",
  "processed_content": {
    "success": true,
    "arxiv_id": "2509.16117v1",
    "metadata": {
      "arxiv_id": "2509.16117v1",
      "title": "DiffusionNFT: Online Diffusion Reinforcement with Forward Process",
      "authors": [],
      "abstract": "Online reinforcement learning (RL) has been central to post-training language models, but its extension to diffusion models remains challenging due to intractable likelihoods. Recent works discretize the reverse sampling process to enable GRPO-style training, yet they inherit fundamental drawbacks, including solver restrictions, forward\u2013reverse inconsistency, and complicated integration with classifier-free guidance (CFG).\nWe introduce Diffusion Negative-aware FineTuning (DiffusionNFT), a new online RL paradigm that optimizes diffusion models directly on the forward process via flow matching.\nDiffusionNFT contrasts positive and negative generations to define an implicit policy improvement direction, naturally incorporating reinforcement signals into the supervised learning objective.\nThis formulation enables training with arbitrary black-box solvers, eliminates the need for likelihood estimation, and requires only clean images rather than sampling trajectories for policy optimization. DiffusionNFT is up to 25\u00d725\\times more efficient than FlowGRPO in head-to-head comparisons, while being CFG-free. For instance, DiffusionNFT improves the GenEval score from 0.24 to 0.98 within 1k steps, while FlowGRPO achieves 0.95 with over 5k steps and additional CFG employment. By leveraging multiple reward models, DiffusionNFT significantly boosts the performance of SD3.5-Medium in every benchmark tested."
    },
    "content": "<div class=\"arxiv-content\">\n<div class=\"ltx_page_content\">\n<article class=\"ltx_document ltx_authors_1line\">\n<h1 class=\"ltx_title ltx_title_document\" id=\"diffusionnft-online-diffusion-reinforcement-with-forward-process\">DiffusionNFT: Online Diffusion Reinforcement with Forward Process</h1>\n<div class=\"ltx_authors\">\n<span class=\"ltx_creator ltx_role_author\">\n<span class=\"ltx_personname\">\nKaiwen Zheng<sup class=\"ltx_sup\"><span class=\"ltx_text ltx_font_italic\">1,2,\u2217</span></sup> \u2002\u2005\nHuayu Chen<sup class=\"ltx_sup\"><span class=\"ltx_text ltx_font_italic\">1,2,\u2217</span></sup> \u2002\u2005\nHaotian Ye<sup class=\"ltx_sup\"><span class=\"ltx_text ltx_font_italic\">2,3</span></sup> \u2002\u2005\nHaoxiang Wang<sup class=\"ltx_sup\">2</sup> \u2002\u2005\nQinsheng Zhang<sup class=\"ltx_sup\">2</sup>\n</span></span>\n<span class=\"ltx_author_before\">\u2003\u2003</span><span class=\"ltx_creator ltx_role_author\">\n<span class=\"ltx_personname\">\n\u2003\u2003\u2003Kai Jiang<sup class=\"ltx_sup\">1</sup> \u2003\nHang Su<sup class=\"ltx_sup\"><span class=\"ltx_text ltx_font_italic\">1</span></sup> \u2003\nStefano Ermon<sup class=\"ltx_sup\"><span class=\"ltx_text ltx_font_italic\">3</span></sup> \u2003\nJun Zhu<sup class=\"ltx_sup\"><span class=\"ltx_text ltx_font_italic\">1,\u2020</span></sup> \u2003\nMing-Yu Liu<sup class=\"ltx_sup\"><span class=\"ltx_text ltx_font_italic\">2</span></sup>\n<br class=\"ltx_break\"/>\n\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2002\u2004\u200a\n<sup class=\"ltx_sup\">\u2217</sup>Equal Contribution \u2003<sup class=\"ltx_sup\">\u2020</sup> Corresponding Author \u2003\n<br class=\"ltx_break\"/>\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u200a\n<sup class=\"ltx_sup\">1</sup>Tsinghua University \u2003<sup class=\"ltx_sup\">2</sup>NVIDIA \u2003<sup class=\"ltx_sup\">3</sup>Stanford University \n\n<br class=\"ltx_break\"/>\u2003\u2003\u2003\u2003\u2002<a class=\"ltx_ref ltx_url ltx_font_typewriter\" href=\"https://research.nvidia.com/labs/dir/DiffusionNFT\" title=\"\">https://research.nvidia.com/labs/dir/DiffusionNFT</a>\n</span></span>\n</div>\n<div class=\"ltx_abstract\">\n<h6 class=\"ltx_title ltx_title_abstract\" id=\"abstract\">Abstract</h6>\n\n</div>\n<figure class=\"ltx_figure\" id=\"S0.F1\">\n<div class=\"ltx_flex_figure\">\n<div class=\"ltx_flex_cell ltx_flex_size_2\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:186.5pt;\">\n<img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"648\" id=\"S0.F1.g1\" src=\"https://arxiv.org/html/x1.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(a)</p>\n</div>\n</div>\n<div class=\"ltx_flex_cell ltx_flex_size_2\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:173.4pt;\">\n<img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_square\" height=\"722\" id=\"S0.F1.g2\" src=\"https://arxiv.org/html/x2.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(b)</p>\n</div>\n</div>\n</div>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 1: </span> Performance of DiffusionNFT. <span class=\"ltx_text ltx_font_bold\">(a)</span> Head-to-head comparison with FlowGRPO on the GenEval task. <span class=\"ltx_text ltx_font_bold\">(b)</span> By employing multiple reward models, DiffusionNFT significantly boosts the performance of SD3.5-Medium in every benchmark tested, while being fully CFG-free.</figcaption>\n</figure>\n<section class=\"ltx_section\" id=\"S1\">\n<h2 class=\"ltx_title ltx_title_section\" id=\"1-introduction\">\n<span class=\"ltx_tag ltx_tag_section\">1 </span>Introduction</h2>\n<div class=\"ltx_para ltx_noindent\" id=\"S1.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S1.p2\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S1.p3\">\n<p class=\"ltx_p\"><span class=\"ltx_text ltx_font_italic\">There is a single forward (noising) but various reverse (denoising) processes for a diffusion policy. Can diffusion reinforcement be performed on the forward process instead of the reverse?</span></p>\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S1.p4\">\n<p class=\"ltx_p\">We propose a new online RL paradigm: Diffusion Negative-aware FineTuning (DiffusionNFT). DiffusionNFT is not built on the Policy Gradient framework. Instead, it performs policy optimization directly on the forward diffusion process through the flow matching objective. Intuitively, DiffusionNFT splits generated samples into positive and negative subsets and defines a contrastive improvement direction between the two policies learned on them. Moreover, unlike conventional guidance techniques that modify the sampling process, DiffusionNFT adopts an implicit parameterization technique that allows integrating reinforcement guidance directly into the optimized policy.</p>\n</div>\n<figure class=\"ltx_figure\" id=\"S1.F2\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"179\" id=\"S1.F2.g1\" src=\"https://arxiv.org/html/x3.png\" width=\"581\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 2: </span>Comparison between Forward-Process RL (NFT) and Reverse-Process RL (GRPO). NFT allows using any solvers and does not require storing the whole sampling trajectory for optimization.</figcaption>\n</figure>\n<div class=\"ltx_para ltx_noindent\" id=\"S1.p5\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S1.p6\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S1.p7\">\n\n</div>\n</section>\n<section class=\"ltx_section\" id=\"S2\">\n<h2 class=\"ltx_title ltx_title_section\" id=\"2-background\">\n<span class=\"ltx_tag ltx_tag_section\">2 </span>Background</h2>\n<section class=\"ltx_subsection\" id=\"S2.SS1\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"21-diffusion-and-flow-models\">\n<span class=\"ltx_tag ltx_tag_subsection\">2.1 </span>Diffusion and Flow Models</h3>\n<div class=\"ltx_para ltx_noindent\" id=\"S2.SS1.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S2.SS1.p2\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S2.Ex1\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{x}}_{t}=\\alpha_{t}{\\bm{x}}_{0}+\\sigma_{t}\\bm{\\epsilon},\\bm{\\epsilon}\\sim{\\mathcal{N}}(\\bm{0},{\\mathbf{I}}).\" class=\"ltx_Math\" display=\"block\" id=\"S2.Ex1.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>=</mo><mrow><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo>+</mo><mrow><msub><mi>\u03c3</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi></mrow></mrow></mrow><mo>,</mo><mrow><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mo>\u223c</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mn>\ud835\udfce</mn><mo>,</mo><mi>\ud835\udc08</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">{\\bm{x}}_{t}=\\alpha_{t}{\\bm{x}}_{0}+\\sigma_{t}\\bm{\\epsilon},\\bm{\\epsilon}\\sim{\\mathcal{N}}(\\bm{0},{\\mathbf{I}}).</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S2.E1\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathbb{E}_{t,{\\bm{x}}_{0}\\sim\\pi_{0},\\bm{\\epsilon}\\sim{\\mathcal{N}}(\\bm{0},{\\mathbf{I}})}[w(t)\\|{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)-{\\bm{v}}\\|_{2}^{2}],\" class=\"ltx_Math\" display=\"block\" id=\"S2.E1.m1\" intent=\":literal\"><semantics><mrow><mrow><msub><mi>\ud835\udd3c</mi><mrow><mrow><mrow><mi>t</mi><mo>,</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo>\u223c</mo><msub><mi>\u03c0</mi><mn>0</mn></msub></mrow><mo>,</mo><mrow><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mo>\u223c</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mn>\ud835\udfce</mn><mo>,</mo><mi>\ud835\udc08</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>w</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}_{t,{\\bm{x}}_{0}\\sim\\pi_{0},\\bm{\\epsilon}\\sim{\\mathcal{N}}(\\bm{0},{\\mathbf{I}})}[w(t)\\|{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)-{\\bm{v}}\\|_{2}^{2}],</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(1)</span></td>\n</tr></tbody>\n</table>\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S2.SS1.p3\">\n\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S2.SS2\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"22-policy-gradient-algorithms-for-diffusion-models\">\n<span class=\"ltx_tag ltx_tag_subsection\">2.2 </span>Policy Gradient Algorithms for Diffusion Models</h3>\n<div class=\"ltx_para ltx_noindent\" id=\"S2.SS2.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S2.SS2.p2\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S2.E2\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathrm{d}{\\bm{x}}_{t}=\\Big[{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\frac{g_{t}^{2}}{2t}\\big({\\bm{x}}_{t}+(1-t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)\\big)\\Big]\\mathrm{d}t+g_{t}\\mathrm{d}{\\bm{w}}_{t}\" class=\"ltx_Math\" display=\"block\" id=\"S2.E2.m1\" intent=\":literal\"><semantics><mrow><mrow><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>=</mo><mrow><mrow><mrow><mo maxsize=\"1.600em\" minsize=\"1.600em\">[</mo><mrow><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo maxsize=\"1.200em\" minsize=\"1.200em\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"1.200em\" minsize=\"1.200em\">)</mo></mrow></mrow></mrow><mo maxsize=\"1.600em\" minsize=\"1.600em\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow><mo>+</mo><mrow><msub><mi>g</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc98</mi><mi>t</mi></msub></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathrm{d}{\\bm{x}}_{t}=\\Big[{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\frac{g_{t}^{2}}{2t}\\big({\\bm{x}}_{t}+(1-t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)\\big)\\Big]\\mathrm{d}t+g_{t}\\mathrm{d}{\\bm{w}}_{t}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(2)</span></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S2.Ex2\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi_{\\theta}({\\bm{x}}_{t-\\Delta t}\\mid{\\bm{x}}_{t})={\\mathcal{N}}\\Big({\\bm{x}}_{t}+\\Big[{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\frac{g_{t}^{2}}{2t}({\\bm{x}}_{t}+(1-t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t))\\Big]\\Delta t,\\;g_{t}^{2}\\Delta t\\,{\\mathbf{I}}\\Big).\" class=\"ltx_Math\" display=\"block\" id=\"S2.Ex2.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msub><mi>\u03c0</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mrow><mi>t</mi><mo>\u2212</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow></mrow></msub><mo>\u2223</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo maxsize=\"1.600em\" minsize=\"1.600em\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>+</mo><mrow><mrow><mo maxsize=\"1.600em\" minsize=\"1.600em\">[</mo><mrow><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"1.600em\" minsize=\"1.600em\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">\u0394</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow></mrow><mo rspace=\"0.447em\">,</mo><mrow><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">\u0394</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi><mo lspace=\"0.170em\" rspace=\"0em\">\u200b</mo><mi>\ud835\udc08</mi></mrow><mo maxsize=\"1.600em\" minsize=\"1.600em\">)</mo></mrow></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">\\pi_{\\theta}({\\bm{x}}_{t-\\Delta t}\\mid{\\bm{x}}_{t})={\\mathcal{N}}\\Big({\\bm{x}}_{t}+\\Big[{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\frac{g_{t}^{2}}{2t}({\\bm{x}}_{t}+(1-t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t))\\Big]\\Delta t,\\;g_{t}^{2}\\Delta t\\,{\\mathbf{I}}\\Big).</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">This makes transition kernels between adjacent steps likelihood tractable Gaussians, enabling the direct application of existing policy gradient algorithms, such as GRPO.</p>\n</div>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"S3\">\n<h2 class=\"ltx_title ltx_title_section\" id=\"3-diffusion-reinforcement-via-negative-aware-finetuning\">\n<span class=\"ltx_tag ltx_tag_section\">3 </span>Diffusion Reinforcement via Negative-aware Finetuning</h2>\n<section class=\"ltx_subsection\" id=\"S3.SS1\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"31-problem-setup\">\n<span class=\"ltx_tag ltx_tag_subsection\">3.1 </span>Problem Setup</h3>\n<section class=\"ltx_paragraph\" id=\"S3.SS1.SSS0.Px1\">\n<h5 class=\"ltx_title ltx_title_paragraph\" id=\"online-rl\">Online RL.</h5>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS1.SSS0.Px1.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS1.SSS0.Px1.p2\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex3\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=1,{\\bm{c}})=\\frac{p(\\mathbf{o}=1|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}=\\frac{r({\\bm{x}}_{0},{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex3.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03c0</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc28</mi></mrow><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=1,{\\bm{c}})=\\frac{p(\\mathbf{o}=1|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}=\\frac{r({\\bm{x}}_{0},{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex4\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{-}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=0,{\\bm{c}})=\\frac{p(\\mathbf{o}=0|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=0|{\\bm{c}})}=\\frac{1-r({\\bm{x}}_{0},{\\bm{c}})}{1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex4.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03c0</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc28</mi></mrow><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>0</mn><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><mn>1</mn><mo>\u2212</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{-}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=0,{\\bm{c}})=\\frac{p(\\mathbf{o}=0|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=0|{\\bm{c}})}=\\frac{1-r({\\bm{x}}_{0},{\\bm{c}})}{1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS1.SSS0.Px1.p3\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex5\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\quad\\quad\\quad\\mathbb{E}_{\\pi^{*}(\\cdot|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})&gt;\\mathbb{E}_{\\pi^{\\text{old}}(\\cdot|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\\quad\\quad(\\text{denoted as}\\quad\\pi^{*}\\succ\\pi^{\\text{old}})\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S3.Ex5.m1\" intent=\":literal\"><semantics><mrow><mrow><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mo>\u2217</mo></msup><mrow><mo stretchy=\"false\">(</mo><mo lspace=\"0em\" rspace=\"0em\">\u22c5</mo><mo fence=\"false\" rspace=\"0.167em\" stretchy=\"false\">|</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&gt;</mo><mrow><mrow><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mrow><mo stretchy=\"false\">(</mo><mo lspace=\"0em\" rspace=\"0em\">\u22c5</mo><mo fence=\"false\" rspace=\"0.167em\" stretchy=\"false\">|</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mspace style=\"width:2em;\" width=\"2em\"></mspace><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mtext>denoted as</mtext><mspace style=\"width:1em;\" width=\"1em\"></mspace><msup><mi>\u03c0</mi><mo>\u2217</mo></msup></mrow><mo>\u227b</mo><msup><mi>\u03c0</mi><mtext>old</mtext></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\quad\\quad\\quad\\mathbb{E}_{\\pi^{*}(\\cdot|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})&gt;\\mathbb{E}_{\\pi^{\\text{old}}(\\cdot|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\\quad\\quad(\\text{denoted as}\\quad\\pi^{*}\\succ\\pi^{\\text{old}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S3.SS1.SSS0.Px2\">\n<h5 class=\"ltx_title ltx_title_paragraph\" id=\"policy-improvement-on-positive-data\">Policy Improvement on Positive Data.</h5>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS1.SSS0.Px2.p1\">\n\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S3.SS1.SSS0.Px3\">\n<h5 class=\"ltx_title ltx_title_paragraph\" id=\"reinforcement-guidance\">Reinforcement Guidance.</h5>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS1.SSS0.Px3.p1\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.E3\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{v}}^{*}({\\bm{x}}_{t},{\\bm{c}},t):={\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\frac{1}{\\beta}\\Delta({\\bm{x}}_{t},{\\bm{c}},t).\" class=\"ltx_Math\" display=\"block\" id=\"S3.E3.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msup><mi>\ud835\udc97</mi><mo>\u2217</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">\u0394</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}^{*}({\\bm{x}}_{t},{\\bm{c}},t):={\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\frac{1}{\\beta}\\Delta({\\bm{x}}_{t},{\\bm{c}},t).</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(3)</span></td>\n</tr></tbody>\n</table>\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS1.SSS0.Px3.p2\">\n\n</div>\n</section>\n</section>\n<section class=\"ltx_subsection\" id=\"S3.SS2\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"32-negative-aware-diffusion-reinforcement-with-forward-process\">\n<span class=\"ltx_tag ltx_tag_subsection\">3.2 </span>Negative-aware Diffusion Reinforcement with Forward Process</h3>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p1\">\n\n</div>\n<div class=\"ltx_theorem ltx_theorem_theorem\" id=\"S3.Thmtheorem1\">\n<h6 class=\"ltx_title ltx_runin ltx_title_theorem\" id=\"theorem-31-improvement-direction\">\n<span class=\"ltx_tag ltx_tag_theorem\"><span class=\"ltx_text ltx_font_bold\">Theorem 3.1</span></span><span class=\"ltx_text ltx_font_bold\"> </span>(<span class=\"ltx_text ltx_font_bold\">Improvement Direction</span>)<span class=\"ltx_text ltx_font_bold\">.</span>\n</h6>\n<div class=\"ltx_para\" id=\"S3.Thmtheorem1.p1\">\n\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx1\">\n<tbody id=\"S3.Ex6\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\Delta:=\" class=\"ltx_Math\" display=\"inline\" id=\"S3.Ex6.m1\" intent=\":literal\"><semantics><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>:=</mo><mi></mi></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\Delta:=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle[1-\\alpha({\\bm{x}}_{t})]\\;[{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)]\\quad\\text{(Reinforcement Guidance)}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.Ex6.m2\" intent=\":literal\"><semantics><mrow><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0.280em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mspace style=\"width:1em;\" width=\"1em\"></mspace><mtext class=\"ltx_mathvariant_italic\">(Reinforcement Guidance)</mtext></mrow><annotation encoding=\"application/x-tex\">\\displaystyle[1-\\alpha({\\bm{x}}_{t})]\\;[{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)]\\quad\\text{(Reinforcement Guidance)}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"S3.E4\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle=\" class=\"ltx_Math\" display=\"inline\" id=\"S3.E4.m1\" intent=\":literal\"><semantics><mo>=</mo><annotation encoding=\"application/x-tex\">\\displaystyle=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\quad\\alpha({\\bm{x}}_{t})\\quad\\;\\;[{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)].\" class=\"ltx_Math\" display=\"inline\" id=\"S3.E4.m2\" intent=\":literal\"><semantics><mrow><mrow><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mspace style=\"width:1.55555555555556em;\" width=\"1.55555555555556em\"></mspace><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msup><mi>\ud835\udc97</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\quad\\alpha({\\bm{x}}_{t})\\quad\\;\\;[{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)].</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(4)</span></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex7\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\alpha({\\bm{x}}_{t}):=\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex7.m1\" intent=\":literal\"><semantics><mrow><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\alpha({\\bm{x}}_{t}):=\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</div>\n<figure class=\"ltx_figure ltx_align_floatright\" id=\"S3.F3\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_img_landscape\" height=\"357\" id=\"S3.F3.g1\" src=\"https://arxiv.org/html/x4.png\" width=\"830\"/>\n<br class=\"ltx_break\"/>\n<figcaption class=\"ltx_caption\"><span class=\"ltx_tag ltx_tag_figure\">Figure 3: </span> Improvement Direction.</figcaption>\n</figure>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p2\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p3\">\n\n</div>\n<figure class=\"ltx_figure\" id=\"S3.F4\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"178\" id=\"S3.F4.g1\" src=\"https://arxiv.org/html/x5.png\" width=\"830\"/>\n<br class=\"ltx_break ltx_centering\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 4: </span> DiffusionNFT jointly optimizes two dual diffusion objectives, on both positive (<math alttext=\"r=1\" class=\"ltx_Math\" display=\"inline\" id=\"S3.F4.m6\" intent=\":literal\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math>) and negative (<math alttext=\"r=0\" class=\"ltx_Math\" display=\"inline\" id=\"S3.F4.m7\" intent=\":literal\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math>) branches. Rather than training two independent models <math alttext=\"{\\bm{v}}_{\\theta}^{+}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.F4.m8\" intent=\":literal\"><semantics><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><annotation encoding=\"application/x-tex\">{\\bm{v}}_{\\theta}^{+}</annotation></semantics></math> and <math alttext=\"{\\bm{v}}_{\\theta}^{-}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.F4.m9\" intent=\":literal\"><semantics><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><annotation encoding=\"application/x-tex\">{\\bm{v}}_{\\theta}^{-}</annotation></semantics></math>, it adopts an implicit parameterization technique that directly optimizes a single target policy <math alttext=\"{\\bm{v}}_{\\theta}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.F4.m10\" intent=\":literal\"><semantics><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><annotation encoding=\"application/x-tex\">{\\bm{v}}_{\\theta}</annotation></semantics></math>.</figcaption>\n</figure>\n<div class=\"ltx_theorem ltx_theorem_theorem\" id=\"S3.Thmtheorem2\">\n<h6 class=\"ltx_title ltx_runin ltx_title_theorem\" id=\"theorem-32-policy-optimization\">\n<span class=\"ltx_tag ltx_tag_theorem\"><span class=\"ltx_text ltx_font_bold\">Theorem 3.2</span></span><span class=\"ltx_text ltx_font_bold\"> </span>(<span class=\"ltx_text ltx_font_bold\">Policy Optimization</span>)<span class=\"ltx_text ltx_font_bold\">.</span>\n</h6>\n<div class=\"ltx_para\" id=\"S3.Thmtheorem2.p1\">\n<p class=\"ltx_p\"><span class=\"ltx_text ltx_font_italic\">Consider the training objective:</span></p>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.E5\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathcal{L}(\\theta)=\\mathbb{E}_{{\\bm{c}},\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}}),t}\\;r\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+(1-r)\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2},\" class=\"ltx_Math\" display=\"block\" id=\"S3.E5.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi>t</mi></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>r</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}(\\theta)=\\mathbb{E}_{{\\bm{c}},\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}}),t}\\;r\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+(1-r)\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2},</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(5)</span></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex8\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\quad\\quad\\text{where}\\quad{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t):=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t),\\quad\\text{(Implicit positive policy)}\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex8.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mtext class=\"ltx_mathvariant_italic\">where</mtext><mspace style=\"width:1em;\" width=\"1em\"></mspace><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>:=</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>\u03b2</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"1.167em\">,</mo><mtext class=\"ltx_mathvariant_italic\">(Implicit positive policy)</mtext></mrow><annotation encoding=\"application/x-tex\">\\quad\\quad\\text{where}\\quad{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t):=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t),\\quad\\text{(Implicit positive policy)}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex9\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\;\\;\\quad\\quad\\text{and}\\;\\;\\quad{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t):=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t).\\quad\\text{(Implicit negative policy)}\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S3.Ex9.m1\" intent=\":literal\"><semantics><mrow><mtext class=\"ltx_mathvariant_italic\">and</mtext><mspace style=\"width:1.55555555555556em;\" width=\"1.55555555555556em\"></mspace><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>:=</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><mi>\u03b2</mi><mo stretchy=\"false\">)</mo></mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><mi>\u03b2</mi><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\">.</mo><mspace style=\"width:1.167em;\" width=\"1.167em\"></mspace><mtext class=\"ltx_mathvariant_italic\">(Implicit negative policy)</mtext></mrow><annotation encoding=\"application/x-tex\">\\;\\;\\quad\\quad\\text{and}\\;\\;\\quad{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t):=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t).\\quad\\text{(Implicit negative policy)}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.E6\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{v}}_{\\theta^{*}}({\\bm{x}}_{t},{\\bm{c}},t)={\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\frac{2}{\\beta}\\Delta({\\bm{x}}_{t},{\\bm{c}},t).\" class=\"ltx_Math\" display=\"block\" id=\"S3.E6.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msub><mi>\ud835\udc97</mi><msup><mi>\u03b8</mi><mo>\u2217</mo></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>2</mn><mi>\u03b2</mi></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">\u0394</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}_{\\theta^{*}}({\\bm{x}}_{t},{\\bm{c}},t)={\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\frac{2}{\\beta}\\Delta({\\bm{x}}_{t},{\\bm{c}},t).</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(6)</span></td>\n</tr></tbody>\n</table>\n</div>\n</div>\n<div class=\"ltx_pagination ltx_role_newpage\"></div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p4\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p5\">\n<p class=\"ltx_p\">Below, we discuss several distinctive advantages of DiffusionNFT.</p>\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p6\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p7\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p8\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS2.p9\">\n\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S3.SS3\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"33-practical-implementation\">\n<span class=\"ltx_tag ltx_tag_subsection\">3.3 </span>Practical Implementation</h3>\n<figure class=\"ltx_float ltx_float_algorithm ltx_framed ltx_framed_top\" id=\"alg1\">\n<figcaption class=\"ltx_caption\"><span class=\"ltx_tag ltx_tag_float\"><span class=\"ltx_text ltx_font_bold\">Algorithm 1</span> </span> Diffusion Negative-aware FineTuning (<span class=\"ltx_text ltx_font_bold\">DiffusionNFT</span>)</figcaption><div class=\"ltx_flex_figure\">\n<div class=\"ltx_flex_cell ltx_flex_size_1\">\n\n</div>\n<div class=\"ltx_flex_break\"></div>\n<div class=\"ltx_listing ltx_listing\">\n<div class=\"ltx_listingline\" id=\"alg1.l1\">\n<span class=\"ltx_tag ltx_tag_listingline\">1:</span><span class=\"ltx_text ltx_font_bold\">for</span> each iteration <math alttext=\"i\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l1.m1\" intent=\":literal\"><semantics><mi>i</mi><annotation encoding=\"application/x-tex\">i</annotation></semantics></math> <span class=\"ltx_text ltx_font_bold\">do</span>\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l2\">\n<span class=\"ltx_tag ltx_tag_listingline\">2:</span>\u2003\u2002<span class=\"ltx_text ltx_font_bold\">for</span> each sampled prompt <math alttext=\"{\\bm{c}}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l2.m1\" intent=\":literal\"><semantics><mi>\ud835\udc84</mi><annotation encoding=\"application/x-tex\">{\\bm{c}}</annotation></semantics></math> <span class=\"ltx_text ltx_font_bold\">do</span> <span class=\"ltx_text\" style=\"float:right;\"><span class=\"ltx_text ltx_font_italic\" style=\"--ltx-fg-color:#808080;\">// Rollout Step, Data Collection</span>\n</span>\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l3\">\n<span class=\"ltx_tag ltx_tag_listingline\">3:</span>\u2003\u2003\u2003Collect <math alttext=\"K\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l3.m1\" intent=\":literal\"><semantics><mi>K</mi><annotation encoding=\"application/x-tex\">K</annotation></semantics></math> clean images <math alttext=\"{\\bm{x}}^{1:K}_{0}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l3.m2\" intent=\":literal\"><semantics><msubsup><mi>\ud835\udc99</mi><mn>0</mn><mrow><mn>1</mn><mo lspace=\"0.278em\" rspace=\"0.278em\">:</mo><mi>K</mi></mrow></msubsup><annotation encoding=\"application/x-tex\">{\\bm{x}}^{1:K}_{0}</annotation></semantics></math>, and evaluate their rewards <math alttext=\"\\{r^{\\text{raw}}\\}^{1:K}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l3.m3\" intent=\":literal\"><semantics><msup><mrow><mo stretchy=\"false\">{</mo><msup><mi>r</mi><mtext>raw</mtext></msup><mo stretchy=\"false\">}</mo></mrow><mrow><mn>1</mn><mo lspace=\"0.278em\" rspace=\"0.278em\">:</mo><mi>K</mi></mrow></msup><annotation encoding=\"application/x-tex\">\\{r^{\\text{raw}}\\}^{1:K}</annotation></semantics></math>.\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l4\">\n<span class=\"ltx_tag ltx_tag_listingline\">4:</span>\u2003\u2003\u2003Normalize raw rewards in group: <math alttext=\"r^{\\text{norm}}:=r^{\\text{raw}}-\\texttt{mean}(\\{r^{\\text{raw}}\\}^{1:K})\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l4.m1\" intent=\":literal\"><semantics><mrow><msup><mi>r</mi><mtext>norm</mtext></msup><mo>:=</mo><mrow><msup><mi>r</mi><mtext>raw</mtext></msup><mo>\u2212</mo><mrow><mtext class=\"ltx_mathvariant_monospace\">mean</mtext><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msup><mrow><mo stretchy=\"false\">{</mo><msup><mi>r</mi><mtext>raw</mtext></msup><mo stretchy=\"false\">}</mo></mrow><mrow><mn>1</mn><mo lspace=\"0.278em\" rspace=\"0.278em\">:</mo><mi>K</mi></mrow></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">r^{\\text{norm}}:=r^{\\text{raw}}-\\texttt{mean}(\\{r^{\\text{raw}}\\}^{1:K})</annotation></semantics></math>.\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l5\">\n<span class=\"ltx_tag ltx_tag_listingline\">5:</span>\u2003\u2003\u2003Define optimality probability <math alttext=\"r=0.5+0.5*\\texttt{clip}\\{r^{\\text{norm}}/Z_{\\bm{c}},-1,1\\}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l5.m1\" intent=\":literal\"><semantics><mrow><mi>r</mi><mo>=</mo><mrow><mn>0.5</mn><mo>+</mo><mrow><mrow><mn>0.5</mn><mo lspace=\"0.222em\" rspace=\"0.222em\">\u2217</mo><mtext class=\"ltx_mathvariant_monospace\">clip</mtext></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">{</mo><mrow><msup><mi>r</mi><mtext>norm</mtext></msup><mo>/</mo><msub><mi>Z</mi><mi>\ud835\udc84</mi></msub></mrow><mo>,</mo><mrow><mo>\u2212</mo><mn>1</mn></mrow><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">r=0.5+0.5*\\texttt{clip}\\{r^{\\text{norm}}/Z_{\\bm{c}},-1,1\\}</annotation></semantics></math>.\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l6\">\n<span class=\"ltx_tag ltx_tag_listingline\">6:</span>\u2003\u2003\u2003<math alttext=\"\\mathcal{D}\\leftarrow\\{{\\bm{c}},\\;{\\bm{x}}_{0}^{1:K},r^{1:K}\\in[0,1]\\}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l6.m1\" intent=\":literal\"><semantics><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi><mo stretchy=\"false\">\u2190</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mi>\ud835\udc84</mi><mo rspace=\"0.447em\">,</mo><msubsup><mi>\ud835\udc99</mi><mn>0</mn><mrow><mn>1</mn><mo lspace=\"0.278em\" rspace=\"0.278em\">:</mo><mi>K</mi></mrow></msubsup><mo>,</mo><msup><mi>r</mi><mrow><mn>1</mn><mo lspace=\"0.278em\" rspace=\"0.278em\">:</mo><mi>K</mi></mrow></msup></mrow><mo>\u2208</mo><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathcal{D}\\leftarrow\\{{\\bm{c}},\\;{\\bm{x}}_{0}^{1:K},r^{1:K}\\in[0,1]\\}</annotation></semantics></math>.\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l7\">\n<span class=\"ltx_tag ltx_tag_listingline\">7:</span>\u2003\u2002<span class=\"ltx_text ltx_font_bold\">end</span> <span class=\"ltx_text ltx_font_bold\">for</span>\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l8\">\n<span class=\"ltx_tag ltx_tag_listingline\">8:</span>\u2003\u2002<span class=\"ltx_text ltx_font_bold\">for</span> each mini batch <math alttext=\"\\{{\\bm{c}},{\\bm{x}}_{0},r\\}\\in\\mathcal{D}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l8.m1\" intent=\":literal\"><semantics><mrow><mrow><mo stretchy=\"false\">{</mo><mi>\ud835\udc84</mi><mo>,</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>r</mi><mo stretchy=\"false\">}</mo></mrow><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi></mrow><annotation encoding=\"application/x-tex\">\\{{\\bm{c}},{\\bm{x}}_{0},r\\}\\in\\mathcal{D}</annotation></semantics></math> <span class=\"ltx_text ltx_font_bold\">do</span> <span class=\"ltx_text\" style=\"float:right;\"><span class=\"ltx_text ltx_font_italic\" style=\"--ltx-fg-color:#808080;\">// Gradient Step, Policy Optimization</span>\n</span>\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l9\">\n<span class=\"ltx_tag ltx_tag_listingline\">9:</span>\u2003\u2003\u2003Forward diffusion process: <math alttext=\"{\\bm{x}}_{t}=\\alpha_{t}{\\bm{x}}_{0}+\\sigma_{t}\\bm{\\epsilon}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l9.m1\" intent=\":literal\"><semantics><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>=</mo><mrow><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo>+</mo><mrow><msub><mi>\u03c3</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{x}}_{t}=\\alpha_{t}{\\bm{x}}_{0}+\\sigma_{t}\\bm{\\epsilon}</annotation></semantics></math>; \u2004 <math alttext=\"{\\bm{v}}=\\dot{\\alpha}_{t}{\\bm{x}}_{0}+\\dot{\\sigma}_{t}\\bm{\\epsilon}\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l9.m2\" intent=\":literal\"><semantics><mrow><mi>\ud835\udc97</mi><mo>=</mo><mrow><mrow><msub><mover accent=\"true\"><mi>\u03b1</mi><mo>\u02d9</mo></mover><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo>+</mo><mrow><msub><mover accent=\"true\"><mi>\u03c3</mi><mo>\u02d9</mo></mover><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}=\\dot{\\alpha}_{t}{\\bm{x}}_{0}+\\dot{\\sigma}_{t}\\bm{\\epsilon}</annotation></semantics></math>.\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l10\">\n<span class=\"ltx_tag ltx_tag_listingline\">10:</span>\u2003\u2003\u2003Implicit positive velocity: <math alttext=\"{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t):=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l10.m1\" intent=\":literal\"><semantics><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>\u03b2</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t):=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)</annotation></semantics></math>.\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l11\">\n<span class=\"ltx_tag ltx_tag_listingline\">11:</span>\u2003\u2003\u2003Implicit negative velocity: <math alttext=\"{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t):=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l11.m1\" intent=\":literal\"><semantics><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>+</mo><mi>\u03b2</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t):=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)</annotation></semantics></math>.\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l12\">\n<span class=\"ltx_tag ltx_tag_listingline\">12:</span>\u2003\u2003\u2003<math alttext=\"\\theta\\leftarrow\\theta-\\lambda\\nabla_{\\theta}\\left[r\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+(1-r)\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\right]\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l12.m1\" intent=\":literal\"><semantics><mrow><mi>\u03b8</mi><mo stretchy=\"false\">\u2190</mo><mrow><mi>\u03b8</mi><mo>\u2212</mo><mrow><mi>\u03bb</mi><mo lspace=\"0.167em\" rspace=\"0em\">\u200b</mo><mrow><msub><mo>\u2207</mo><mi>\u03b8</mi></msub><mrow><mo>[</mo><mrow><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>r</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\theta\\leftarrow\\theta-\\lambda\\nabla_{\\theta}\\left[r\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+(1-r)\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\right]</annotation></semantics></math>.\u2003\u2004\u200a (Eq.\u00a0(<a class=\"ltx_ref\" href=\"https://arxiv.org/html/2509.16117v1#S3.E5\" title=\"In Theorem 3.2 (Policy Optimization). \u2023 3.2 Negative-aware Diffusion Reinforcement with Forward Process \u2023 3 Diffusion Reinforcement via Negative-aware Finetuning \u2023 DiffusionNFT: Online Diffusion Reinforcement with Forward Process\"><span class=\"ltx_text ltx_ref_tag\">5</span></a>))\n\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l13\">\n<span class=\"ltx_tag ltx_tag_listingline\">13:</span>\u2003\u2002<span class=\"ltx_text ltx_font_bold\">end</span> <span class=\"ltx_text ltx_font_bold\">for</span>\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l14\">\n<span class=\"ltx_tag ltx_tag_listingline\">14:</span>\u2003\u2002Update data collection policy <math alttext=\"\\theta^{\\text{old}}\\leftarrow\\eta_{i}\\theta^{\\text{old}}+(1-\\eta_{i})\\theta\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l14.m1\" intent=\":literal\"><semantics><mrow><msup><mi>\u03b8</mi><mtext>old</mtext></msup><mo stretchy=\"false\">\u2190</mo><mrow><mrow><msub><mi>\u03b7</mi><mi>i</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03b8</mi><mtext>old</mtext></msup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><msub><mi>\u03b7</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>\u03b8</mi></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\theta^{\\text{old}}\\leftarrow\\eta_{i}\\theta^{\\text{old}}+(1-\\eta_{i})\\theta</annotation></semantics></math>, and clear buffer <math alttext=\"\\mathcal{D}\\leftarrow\\emptyset\" class=\"ltx_Math\" display=\"inline\" id=\"alg1.l14.m2\" intent=\":literal\"><semantics><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi><mo stretchy=\"false\">\u2190</mo><mi mathvariant=\"normal\">\u2205</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{D}\\leftarrow\\emptyset</annotation></semantics></math>. <span class=\"ltx_text\" style=\"float:right;\"><span class=\"ltx_text ltx_font_italic\" style=\"--ltx-fg-color:#808080;\">// Online Update</span>\n</span>\n</div>\n<div class=\"ltx_listingline\" id=\"alg1.l15\">\n<span class=\"ltx_tag ltx_tag_listingline\">15:</span><span class=\"ltx_text ltx_font_bold\">end</span> <span class=\"ltx_text ltx_font_bold\">for</span>\n</div>\n</div>\n<div class=\"ltx_flex_break\"></div>\n<div class=\"ltx_flex_cell ltx_flex_size_1\">\n\n</div>\n</div>\n</figure>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS3.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS3.p2\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex10\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"r({\\bm{x}}_{0},{\\bm{c}}):=\\frac{1}{2}+\\frac{1}{2}\\texttt{clip}\\left[\\frac{r^{\\text{raw}}({\\bm{x}}_{0},{\\bm{c}})-\\mathbb{E}_{\\pi^{\\text{old}}(\\cdot|{\\bm{c}})}r^{\\text{raw}}({\\bm{x}}_{0},{\\bm{c}})}{Z_{\\bm{c}}},-1,1\\right].\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S3.Ex10.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mtext class=\"ltx_mathvariant_monospace\">clip</mtext><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo>[</mo><mfrac><mrow><mrow><msup><mi>r</mi><mtext>raw</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mrow><mo stretchy=\"false\">(</mo><mo lspace=\"0em\" rspace=\"0em\">\u22c5</mo><mo fence=\"false\" rspace=\"0.167em\" stretchy=\"false\">|</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>r</mi><mtext>raw</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><msub><mi>Z</mi><mi>\ud835\udc84</mi></msub></mfrac><mo>,</mo><mrow><mo>\u2212</mo><mn>1</mn></mrow><mo>,</mo><mn>1</mn><mo>]</mo></mrow></mrow></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">r({\\bm{x}}_{0},{\\bm{c}}):=\\frac{1}{2}+\\frac{1}{2}\\texttt{clip}\\left[\\frac{r^{\\text{raw}}({\\bm{x}}_{0},{\\bm{c}})-\\mathbb{E}_{\\pi^{\\text{old}}(\\cdot|{\\bm{c}})}r^{\\text{raw}}({\\bm{x}}_{0},{\\bm{c}})}{Z_{\\bm{c}}},-1,1\\right].</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS3.p3\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS3.p4\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex11\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\theta^{\\text{old}}\\leftarrow\\eta_{i}\\theta^{\\text{old}}+(1-\\eta_{i})\\theta\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex11.m1\" intent=\":literal\"><semantics><mrow><msup><mi>\u03b8</mi><mtext>old</mtext></msup><mo stretchy=\"false\">\u2190</mo><mrow><mrow><msub><mi>\u03b7</mi><mi>i</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03b8</mi><mtext>old</mtext></msup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><msub><mi>\u03b7</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>\u03b8</mi></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\theta^{\\text{old}}\\leftarrow\\eta_{i}\\theta^{\\text{old}}+(1-\\eta_{i})\\theta</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS3.p5\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"S3.Ex12\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"w(t)\\|{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\leftarrow\\frac{\\|{\\bm{x}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{x}}_{0}\\|_{2}^{2}}{\\texttt{sg}(\\texttt{mean}(\\texttt{abs}({\\bm{x}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{x}}_{0})))}\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex12.m1\" intent=\":literal\"><semantics><mrow><mrow><mi>w</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy=\"false\">\u2190</mo><mfrac><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msub><mi>\ud835\udc99</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mrow><mtext class=\"ltx_mathvariant_monospace\">sg</mtext><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mtext class=\"ltx_mathvariant_monospace\">mean</mtext><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mtext class=\"ltx_mathvariant_monospace\">abs</mtext><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\ud835\udc99</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">w(t)\\|{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\leftarrow\\frac{\\|{\\bm{x}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{x}}_{0}\\|_{2}^{2}}{\\texttt{sg}(\\texttt{mean}(\\texttt{abs}({\\bm{x}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{x}}_{0})))}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S3.SS3.p6\">\n\n</div>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"S4\">\n<h2 class=\"ltx_title ltx_title_section\" id=\"4-experiments\">\n<span class=\"ltx_tag ltx_tag_section\">4 </span>Experiments</h2>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.p1\">\n<p class=\"ltx_p\">We demonstrate the potential of DiffusionNFT through three perspectives:\n(1) multi-reward joint training for strong CFG-free performance,\n(2) head-to-head comparison with FlowGRPO on single rewards, and\n(3) ablation studies on key design choices.</p>\n</div>\n<section class=\"ltx_subsection\" id=\"S4.SS1\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"41-experimental-setup\">\n<span class=\"ltx_tag ltx_tag_subsection\">4.1 </span>Experimental Setup</h3>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS1.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS1.p2\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS1.p3\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS1.p4\">\n\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S4.SS2\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"42-multi-reward-joint-training\">\n<span class=\"ltx_tag ltx_tag_subsection\">4.2 </span>Multi-Reward Joint Training</h3>\n<figure class=\"ltx_table\" id=\"S4.T1\">\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_table\">Table 1: </span><span class=\"ltx_text ltx_font_bold\">Evaluation Results.</span> <span class=\"ltx_text\" style=\"--ltx-bg-color:#E6E6E6;\">Gray-colored</span>: In-domain reward. <sup class=\"ltx_sup\">\u2020</sup> Evaluated on official checkpoints. <sup class=\"ltx_sup\">\u2021</sup>Evaluated under 1024<math alttext=\"\\times\" class=\"ltx_Math\" display=\"inline\" id=\"S4.T1.m6\" intent=\":literal\"><semantics><mo>\u00d7</mo><annotation encoding=\"application/x-tex\">\\times</annotation></semantics></math>1024 resolution. <span class=\"ltx_text ltx_font_bold\">Bold</span>: best; <span class=\"ltx_text ltx_framed ltx_framed_underline\">Underline</span>: second best.</figcaption>\n<div class=\"ltx_inline-block ltx_align_center ltx_transformed_outer\" style=\"width:433.6pt;height:97.3pt;vertical-align:-46.8pt;\"><span class=\"ltx_transformed_inner\" style=\"transform:translate(-82.3pt,18.5pt) scale(0.724764029192124,0.724764029192124) ;\">\n<table class=\"ltx_tabular ltx_guessed_headers ltx_align_middle table table-responsive\">\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt\" rowspan=\"2\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">Model</span></th>\n<td class=\"ltx_td ltx_align_center ltx_border_tt\" rowspan=\"2\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">#Iter</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_tt\" colspan=\"2\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">Rule-Based</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_tt\" colspan=\"6\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">Model-Based</span></td>\n</tr>\n<tr class=\"ltx_tr\">\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">GenEval</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">OCR</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">PickScore</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">ClipScore</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">HPSv2.1</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">Aesthetic</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">ImgRwd</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">UniRwd</span></td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">SD-XL<sup class=\"ltx_sup\">\u2021</sup>\n</th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">\u2014</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.55</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.14</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">22.42</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.287</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.280</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">5.60</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.76</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">2.93</td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">SD3.5-L<sup class=\"ltx_sup\">\u2021</sup>\n</th>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">\u2014</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.71</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.68</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">22.91</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.289</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.288</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">5.50</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.96</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">3.25</td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">FLUX.1-Dev</th>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">\u2014</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.66</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.59</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">22.84</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.295</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.274</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">5.71</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.96</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">3.27</td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">SD3.5-M (w/o CFG)</th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">\u2014</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.24</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.12</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">20.51</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.237</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.204</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">5.13</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">-0.58</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">2.02</td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">+ CFG</th>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">\u2014</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.63</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.59</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">22.34</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.285</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.279</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">5.36</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.85</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">3.03</td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">\u2002\u200a\u2003+ FlowGRPO<sup class=\"ltx_sup\">\u2020</sup>\n</th>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">\n<math alttext=\"&gt;\" class=\"ltx_Math\" display=\"inline\" id=\"S4.T1.m10\" intent=\":literal\"><semantics><mo>&gt;</mo><annotation encoding=\"application/x-tex\">&gt;</annotation></semantics></math>5k</td>\n<td class=\"ltx_td ltx_align_center\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\" style=\"--ltx-bg-color:#E6E6E6;\">0.95</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.66</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">22.51</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">0.293</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.274</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">5.32</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">1.06</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">3.18</td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_th ltx_th_row\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"></th>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">2k</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.66</td>\n<td class=\"ltx_td ltx_align_center\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\" style=\"--ltx-bg-color:#E6E6E6;\">0.92</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">22.41</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\">0.290</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.280</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">5.32</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.95</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">3.15</td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_th ltx_th_row\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"></th>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">4k</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.54</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.68</td>\n<td class=\"ltx_td ltx_align_center\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\" style=\"--ltx-bg-color:#E6E6E6;\">23.50</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">0.280</td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\">0.316</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\">5.90</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\">1.29</span></td>\n<td class=\"ltx_td ltx_align_center\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\">3.37</span></td>\n</tr>\n<tr class=\"ltx_tr\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">+ Ours</th>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\">1.7k</td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\" style=\"--ltx-bg-color:#E6E6E6;\">0.94</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_framed ltx_framed_underline\" style=\"--ltx-bg-color:#E6E6E6;\">0.91</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\" style=\"--ltx-bg-color:#E6E6E6;\">23.80</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\" style=\"--ltx-bg-color:#E6E6E6;\">0.293</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"--ltx-bg-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\" style=\"--ltx-bg-color:#E6E6E6;\">0.331</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">6.01</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">1.49</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" style=\"padding-top:0.5pt;padding-bottom:0.5pt;\"><span class=\"ltx_text ltx_font_bold\">3.49</span></td>\n</tr>\n</tbody>\n</table>\n</span></div>\n</figure>\n<figure class=\"ltx_figure\" id=\"S4.F5\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"506\" id=\"S4.F5.g1\" src=\"https://arxiv.org/html/x6.png\" width=\"830\"/>\n<br class=\"ltx_break ltx_centering\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 5: </span> <span class=\"ltx_text ltx_font_bold\">Qualitative Comparison.</span> The prompts are taken from <span class=\"ltx_text ltx_font_typewriter\">GenEval</span>, <span class=\"ltx_text ltx_font_typewriter\">OCR</span> and <span class=\"ltx_text ltx_font_typewriter\">DrawBench</span> respectively, where we compare the corresponding FlowGRPO model with our model.</figcaption>\n</figure>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS2.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS2.p2\">\n\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S4.SS3\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"43-head-to-head-comparison\">\n<span class=\"ltx_tag ltx_tag_subsection\">4.3 </span>Head-to-Head Comparison</h3>\n<figure class=\"ltx_figure\" id=\"S4.F6\">\n<div class=\"ltx_flex_figure\">\n<div class=\"ltx_flex_cell ltx_flex_size_3\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:138.8pt;\">\n<img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"651\" id=\"S4.F6.g1\" src=\"https://arxiv.org/html/x7.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(a)</p>\n</div>\n</div>\n<div class=\"ltx_flex_cell ltx_flex_size_3\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:138.8pt;\">\n<img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"646\" id=\"S4.F6.g2\" src=\"https://arxiv.org/html/x8.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(b)</p>\n</div>\n</div>\n<div class=\"ltx_flex_cell ltx_flex_size_3\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:138.8pt;\">\n<img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"652\" id=\"S4.F6.g3\" src=\"https://arxiv.org/html/x9.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(c)</p>\n</div>\n</div>\n</div>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 6: </span> Head-to-head comparison between DiffusionNFT with FlowGRPO on single rewards.</figcaption>\n</figure>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS3.p1\">\n\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S4.SS4\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"44-ablation-studies\">\n<span class=\"ltx_tag ltx_tag_subsection\">4.4 </span>Ablation Studies</h3>\n<figure class=\"ltx_figure\" id=\"S4.SS4.fig3\">\n<div class=\"ltx_block\">\n<figure class=\"ltx_figure ltx_minipage ltx_align_center ltx_align_bottom\" id=\"S4.SS4.fig1\" style=\"width:281.9pt;\">\n<div class=\"ltx_flex_figure\">\n<div class=\"ltx_flex_cell ltx_flex_size_1\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:212.5pt;\">\n<img alt=\"[Uncaptioned image]\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"630\" id=\"S4.SS4.g1\" src=\"https://arxiv.org/html/x10.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(a)</p>\n</div>\n</div>\n<div class=\"ltx_flex_break\"></div>\n<div class=\"ltx_flex_cell ltx_flex_size_1\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:212.5pt;\">\n<img alt=\"[Uncaptioned image]\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"630\" id=\"S4.SS4.g2\" src=\"https://arxiv.org/html/x11.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(b)</p>\n<figure class=\"ltx_figure ltx_align_center\" id=\"S4.F7\">\n<figcaption class=\"ltx_caption\"><span class=\"ltx_tag ltx_tag_figure\">Figure 7: </span> Different diffusion samplers for data collection.</figcaption>\n</figure>\n</div>\n</div>\n</div>\n</figure>\n<figure class=\"ltx_figure ltx_figure_panel ltx_align_center ltx_align_bottom\" id=\"S4.F8\" style=\"width:138.8pt;\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape\" height=\"631\" id=\"S4.SS4.g3\" src=\"https://arxiv.org/html/x12.png\" width=\"830\"/>\n<br class=\"ltx_break ltx_break\"/>\n<figcaption class=\"ltx_caption\"><span class=\"ltx_tag ltx_tag_figure\">Figure 8: </span> Soft-update strategies.</figcaption>\n</figure>\n</div>\n</figure>\n<figure class=\"ltx_figure\" id=\"S4.SS4.fig6\">\n<div class=\"ltx_block\">\n<figure class=\"ltx_figure ltx_minipage ltx_align_center ltx_align_bottom\" id=\"S4.SS4.fig4\" style=\"width:281.9pt;\">\n<div class=\"ltx_flex_figure\">\n<div class=\"ltx_flex_cell ltx_flex_size_1\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:212.5pt;\">\n<img alt=\"[Uncaptioned image]\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"631\" id=\"S4.SS4.g4\" src=\"https://arxiv.org/html/x13.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(a)</p>\n</div>\n</div>\n<div class=\"ltx_flex_break\"></div>\n<div class=\"ltx_flex_cell ltx_flex_size_1\">\n<div class=\"ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle\" style=\"width:212.5pt;\">\n<img alt=\"[Uncaptioned image]\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"630\" id=\"S4.SS4.g5\" src=\"https://arxiv.org/html/x14.png\" width=\"830\"/>\n<p class=\"ltx_p ltx_align_center\">(b)</p>\n<figure class=\"ltx_figure ltx_align_center\" id=\"S4.F9\">\n<figcaption class=\"ltx_caption\"><span class=\"ltx_tag ltx_tag_figure\">Figure 9: </span> Different time-dependent weighting strategies.</figcaption>\n</figure>\n</div>\n</div>\n</div>\n</figure>\n<figure class=\"ltx_figure ltx_figure_panel ltx_align_center ltx_align_bottom\" id=\"S4.F10\" style=\"width:138.8pt;\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape\" height=\"631\" id=\"S4.SS4.g6\" src=\"https://arxiv.org/html/x15.png\" width=\"830\"/>\n<br class=\"ltx_break ltx_break\"/>\n<figcaption class=\"ltx_caption\"><span class=\"ltx_tag ltx_tag_figure\">Figure 10: </span> Choices of strength <math alttext=\"\\beta\" class=\"ltx_Math\" display=\"inline\" id=\"S4.F10.m2\" intent=\":literal\"><semantics><mi>\u03b2</mi><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math>.</figcaption>\n</figure>\n</div>\n</figure>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS4.p1\">\n<p class=\"ltx_p\">We analyze the impact of our core design choices:</p>\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS4.p2\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS4.p3\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS4.p4\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS4.p5\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS4.p6\">\n\n</div>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"S5\">\n<h2 class=\"ltx_title ltx_title_section\" id=\"5-related-work\">\n<span class=\"ltx_tag ltx_tag_section\">5 </span>Related Work</h2>\n<div class=\"ltx_para ltx_noindent\" id=\"S5.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S5.p2\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S5.p3\">\n\n</div>\n</section>\n<section class=\"ltx_section\" id=\"S6\">\n<h2 class=\"ltx_title ltx_title_section\" id=\"6-conclusion\">\n<span class=\"ltx_tag ltx_tag_section\">6 </span>Conclusion</h2>\n<div class=\"ltx_para ltx_noindent\" id=\"S6.p1\">\n\n<div class=\"ltx_pagination ltx_role_newpage\"></div>\n</div>\n<div class=\"ltx_pagination ltx_role_newpage\"></div>\n<section class=\"ltx_subsubsection\" id=\"S6.SS0.SSSx1\">\n<h4 class=\"ltx_title ltx_title_subsubsection\" id=\"acknowledgments\">Acknowledgments</h4>\n<div class=\"ltx_para ltx_noindent\" id=\"S6.SS0.SSSx1.p1\">\n<p class=\"ltx_p\">We thank Cheng Lu, Hanzi Mao, Zekun Hao, Tao Yang, Zhanhao Liang, Shuhuai Ren, Tenglong Ao, Xintao Wang, Haoqi Fan, Jiajun Liang, Yuji Wang, and Hongzhou Zhu for the valuable discussion.</p>\n</div>\n</section>\n</section>\n<section class=\"ltx_bibliography\" id=\"bib\">\n<h2 class=\"ltx_title ltx_title_bibliography\" id=\"references\">References</h2>\n<ul class=\"ltx_biblist\">\n<li class=\"ltx_bibitem\" id=\"bib.bib1\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Achiam et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nJosh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia\u00a0Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">Gpt-4 technical report.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2303.08774</em>, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib2\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Black et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nKevin Black, Michael Janner, Yilun Du, Ilya Kostrikov, and Sergey Levine.\n\n</span>\n<span class=\"ltx_bibblock\">Training diffusion models with reinforcement learning.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2305.13301</em>, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib3\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Chen et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nHuayu Chen, Cheng Lu, Chengyang Ying, Hang Su, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Offline reinforcement learning via high-fidelity generative behavior modeling.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">The Eleventh International Conference on Learning Representations</em>, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib4\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Chen et\u00a0al. (2025a)</span>\n<span class=\"ltx_bibblock\">\nHuayu Chen, Kai Jiang, Kaiwen Zheng, Jianfei Chen, Hang Su, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Visual generation without guidance.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Forty-second international conference on machine learning</em>, 2025a.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib5\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Chen et\u00a0al. (2025b)</span>\n<span class=\"ltx_bibblock\">\nHuayu Chen, Hang Su, Peize Sun, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Toward guidance-free ar visual generation via condition contrastive alignment.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">ICLR</em>, 2025b.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib6\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Chen et\u00a0al. (2025c)</span>\n<span class=\"ltx_bibblock\">\nHuayu Chen, Kaiwen Zheng, Qinsheng Zhang, Ganqu Cui, Yin Cui, Haotian Ye, Tsung-Yi Lin, Ming-Yu Liu, Jun Zhu, and Haoxiang Wang.\n\n</span>\n<span class=\"ltx_bibblock\">Bridging supervised learning and reinforcement learning in math reasoning.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2505.18116</em>, 2025c.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib7\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Clark et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nKevin Clark, Paul Vicol, Kevin Swersky, and David\u00a0J Fleet.\n\n</span>\n<span class=\"ltx_bibblock\">Directly fine-tuning diffusion models on differentiable rewards.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2309.17400</em>, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib8\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Esser et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nPatrick Esser, Sumith Kulal, Andreas Blattmann, Rahim Entezari, Jonas M\u00fcller, Harry Saini, Yam Levi, Dominik Lorenz, Axel Sauer, Frederic Boesel, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">Scaling rectified flow transformers for high-resolution image synthesis.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">Forty-first international conference on machine learning</em>, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib9\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Fan et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nYing Fan, Olivia Watkins, Yuqing Du, Hao Liu, Moonkyung Ryu, Craig Boutilier, Pieter Abbeel, Mohammad Ghavamzadeh, Kangwook Lee, and Kimin Lee.\n\n</span>\n<span class=\"ltx_bibblock\">Dpok: Reinforcement learning for fine-tuning text-to-image diffusion models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in Neural Information Processing Systems</em>, 36:79858\u201379885, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib10\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Frans et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nKevin Frans, Seohong Park, Pieter Abbeel, and Sergey Levine.\n\n</span>\n<span class=\"ltx_bibblock\">Diffusion guidance is a controllable policy improvement operator.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2505.23458</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib11\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Ghosh et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nDhruba Ghosh, Hannaneh Hajishirzi, and Ludwig Schmidt.\n\n</span>\n<span class=\"ltx_bibblock\">Geneval: An object-focused framework for evaluating text-to-image alignment.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in Neural Information Processing Systems</em>, 36:52132\u201352152, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib12\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Gonzalez et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nMartin Gonzalez, Nelson Fernandez\u00a0Pinto, Thuy Tran, Hatem Hajri, Nader Masmoudi, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">Seeds: Exponential sde solvers for fast high-quality sampling from diffusion models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in Neural Information Processing Systems</em>, 36:68061\u201368120, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib13\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Guo et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nDaya Guo, Dejian Yang, Haowei Zhang, Junxiao Song, Ruoyu Zhang, Runxin Xu, Qihao Zhu, Shirong Ma, Peiyi Wang, Xiao Bi, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">Deepseek-r1: Incentivizing reasoning capability in llms via reinforcement learning.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2501.12948</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib14\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Hessel et\u00a0al. (2021)</span>\n<span class=\"ltx_bibblock\">\nJack Hessel, Ari Holtzman, Maxwell Forbes, Ronan\u00a0Le Bras, and Yejin Choi.\n\n</span>\n<span class=\"ltx_bibblock\">Clipscore: A reference-free evaluation metric for image captioning.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2104.08718</em>, 2021.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib15\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Ho &amp; Salimans (2022)</span>\n<span class=\"ltx_bibblock\">\nJonathan Ho and Tim Salimans.\n\n</span>\n<span class=\"ltx_bibblock\">Classifier-free diffusion guidance.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2207.12598</em>, 2022.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib16\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Ho et\u00a0al. (2020)</span>\n<span class=\"ltx_bibblock\">\nJonathan Ho, Ajay Jain, and Pieter Abbeel.\n\n</span>\n<span class=\"ltx_bibblock\">Denoising diffusion probabilistic models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in neural information processing systems</em>, 33:6840\u20136851, 2020.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib17\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Hochbruck &amp; Ostermann (2010)</span>\n<span class=\"ltx_bibblock\">\nMarlis Hochbruck and Alexander Ostermann.\n\n</span>\n<span class=\"ltx_bibblock\">Exponential integrators.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Acta Numerica</em>, 19:209\u2013286, 2010.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib18\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Huang et\u00a0al. (2021)</span>\n<span class=\"ltx_bibblock\">\nChin-Wei Huang, Jae\u00a0Hyun Lim, and Aaron\u00a0C Courville.\n\n</span>\n<span class=\"ltx_bibblock\">A variational perspective on diffusion-based generative models and score matching.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in Neural Information Processing Systems</em>, 34:22863\u201322876, 2021.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib19\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Janner et\u00a0al. (2022)</span>\n<span class=\"ltx_bibblock\">\nMichael Janner, Yilun Du, Joshua Tenenbaum, and Sergey Levine.\n\n</span>\n<span class=\"ltx_bibblock\">Planning with diffusion for flexible behavior synthesis.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">International Conference on Machine Learning</em>, 2022.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib20\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Jin et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nLuozhijie Jin, Zijie Qiu, Jie Liu, Zijie Diao, Lifeng Qiao, Ning Ding, Alex Lamb, and Xipeng Qiu.\n\n</span>\n<span class=\"ltx_bibblock\">Inference-time alignment control for diffusion models with reinforcement learning guidance.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2508.21016</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib21\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Kingma et\u00a0al. (2021)</span>\n<span class=\"ltx_bibblock\">\nDiederik Kingma, Tim Salimans, Ben Poole, and Jonathan Ho.\n\n</span>\n<span class=\"ltx_bibblock\">Variational diffusion models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in neural information processing systems</em>, 34:21696\u201321707, 2021.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib22\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Kirstain et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nYuval Kirstain, Adam Polyak, Uriel Singer, Shahbuland Matiana, Joe Penna, and Omer Levy.\n\n</span>\n<span class=\"ltx_bibblock\">Pick-a-pic: An open dataset of user preferences for text-to-image generation.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in neural information processing systems</em>, 36:36652\u201336663, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib23\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Labs (2024)</span>\n<span class=\"ltx_bibblock\">\nBlack\u00a0Forest Labs.\n\n</span>\n<span class=\"ltx_bibblock\">Flux.\n\n</span>\n<span class=\"ltx_bibblock\"><a class=\"ltx_ref ltx_url ltx_font_typewriter\" href=\"https://github.com/black-forest-labs/flux\" title=\"\">https://github.com/black-forest-labs/flux</a>, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib24\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Lee et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nKimin Lee, Hao Liu, Moonkyung Ryu, Olivia Watkins, Yuqing Du, Craig Boutilier, Pieter Abbeel, Mohammad Ghavamzadeh, and Shixiang\u00a0Shane Gu.\n\n</span>\n<span class=\"ltx_bibblock\">Aligning text-to-image models using human feedback.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2302.12192</em>, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib25\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Levine (2018)</span>\n<span class=\"ltx_bibblock\">\nSergey Levine.\n\n</span>\n<span class=\"ltx_bibblock\">Reinforcement learning and control as probabilistic inference: Tutorial and review.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:1805.00909</em>, 2018.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib26\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Li et\u00a0al. (2025a)</span>\n<span class=\"ltx_bibblock\">\nBinxu Li, Minkai Xu, Meihua Dang, and Stefano Ermon.\n\n</span>\n<span class=\"ltx_bibblock\">Divergence minimization preference optimization for diffusion model alignment.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2507.07510</em>, 2025a.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib27\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Li et\u00a0al. (2025b)</span>\n<span class=\"ltx_bibblock\">\nJunzhe Li, Yutao Cui, Tao Huang, Yinping Ma, Chun Fan, Miles Yang, and Zhao Zhong.\n\n</span>\n<span class=\"ltx_bibblock\">Mixgrpo: Unlocking flow-based grpo efficiency with mixed ode-sde.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2507.21802</em>, 2025b.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib28\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Liang et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nZhanhao Liang, Yuhui Yuan, Shuyang Gu, Bohan Chen, Tiankai Hang, Ji\u00a0Li, and Liang Zheng.\n\n</span>\n<span class=\"ltx_bibblock\">Step-aware preference optimization: Aligning preference with denoising performance at each step.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2406.04314</em>, 2(5):7, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib29\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Lipman et\u00a0al. (2022)</span>\n<span class=\"ltx_bibblock\">\nYaron Lipman, Ricky\u00a0TQ Chen, Heli Ben-Hamu, Maximilian Nickel, and Matt Le.\n\n</span>\n<span class=\"ltx_bibblock\">Flow matching for generative modeling.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2210.02747</em>, 2022.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib30\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Liu et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nJie Liu, Gongye Liu, Jiajun Liang, Yangguang Li, Jiaheng Liu, Xintao Wang, Pengfei Wan, Di\u00a0Zhang, and Wanli Ouyang.\n\n</span>\n<span class=\"ltx_bibblock\">Flow-grpo: Training flow matching models via online rl.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2505.05470</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib31\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Liu et\u00a0al. (2022)</span>\n<span class=\"ltx_bibblock\">\nXingchao Liu, Chengyue Gong, and Qiang Liu.\n\n</span>\n<span class=\"ltx_bibblock\">Flow straight and fast: Learning to generate and transfer data with rectified flow.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2209.03003</em>, 2022.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib32\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Lu et\u00a0al. (2022a)</span>\n<span class=\"ltx_bibblock\">\nCheng Lu, Yuhao Zhou, Fan Bao, Jianfei Chen, Chongxuan Li, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Dpm-solver: A fast ode solver for diffusion probabilistic model sampling in around 10 steps.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in neural information processing systems</em>, 35:5775\u20135787, 2022a.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib33\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Lu et\u00a0al. (2022b)</span>\n<span class=\"ltx_bibblock\">\nCheng Lu, Yuhao Zhou, Fan Bao, Jianfei Chen, Chongxuan Li, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Dpm-solver++: Fast solver for guided sampling of diffusion probabilistic models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2211.01095</em>, 2022b.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib34\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Lu et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nCheng Lu, Huayu Chen, Jianfei Chen, Hang Su, Chongxuan Li, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Contrastive energy prediction for exact energy-guided diffusion sampling in offline reinforcement learning.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2304.12824</em>, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib35\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">\u00d8ksendal (2003)</span>\n<span class=\"ltx_bibblock\">\nBernt \u00d8ksendal.\n\n</span>\n<span class=\"ltx_bibblock\">Stochastic differential equations.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">Stochastic differential equations: an introduction with applications</em>, pp.  38\u201350. Springer, 2003.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib36\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Prabhudesai et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nMihir Prabhudesai, Anirudh Goyal, Deepak Pathak, and Katerina Fragkiadaki.\n\n</span>\n<span class=\"ltx_bibblock\">Aligning text-to-image diffusion models with reward backpropagation.\n\n</span>\n<span class=\"ltx_bibblock\">2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib37\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Prabhudesai et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nMihir Prabhudesai, Russell Mendonca, Zheyang Qin, Katerina Fragkiadaki, and Deepak Pathak.\n\n</span>\n<span class=\"ltx_bibblock\">Video diffusion alignment via reward gradients.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2407.08737</em>, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib38\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Saharia et\u00a0al. (2022)</span>\n<span class=\"ltx_bibblock\">\nChitwan Saharia, William Chan, Saurabh Saxena, Lala Li, Jay Whang, Emily\u00a0L Denton, Kamyar Ghasemipour, Raphael Gontijo\u00a0Lopes, Burcu Karagol\u00a0Ayan, Tim Salimans, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">Photorealistic text-to-image diffusion models with deep language understanding.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in neural information processing systems</em>, 35:36479\u201336494, 2022.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib39\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Schuhmann (2022)</span>\n<span class=\"ltx_bibblock\">\nChristoph Schuhmann.\n\n</span>\n<span class=\"ltx_bibblock\">Laion-aesthetics.\n\n</span>\n<span class=\"ltx_bibblock\"><a class=\"ltx_ref ltx_url ltx_font_typewriter\" href=\"https://laion.ai/blog/laion-aesthetics/\" title=\"\">https://laion.ai/blog/laion-aesthetics/</a>, 2022.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib40\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Schulman et\u00a0al. (2017)</span>\n<span class=\"ltx_bibblock\">\nJohn Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.\n\n</span>\n<span class=\"ltx_bibblock\">Proximal policy optimization algorithms.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:1707.06347</em>, 2017.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib41\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Shao et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nZhihong Shao, Peiyi Wang, Qihao Zhu, Runxin Xu, Junxiao Song, Xiao Bi, Haowei Zhang, Mingchuan Zhang, YK\u00a0Li, Yang Wu, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">Deepseekmath: Pushing the limits of mathematical reasoning in open language models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2402.03300</em>, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib42\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Song et\u00a0al. (2020a)</span>\n<span class=\"ltx_bibblock\">\nJiaming Song, Chenlin Meng, and Stefano Ermon.\n\n</span>\n<span class=\"ltx_bibblock\">Denoising diffusion implicit models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2010.02502</em>, 2020a.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib43\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Song et\u00a0al. (2020b)</span>\n<span class=\"ltx_bibblock\">\nYang Song, Jascha Sohl-Dickstein, Diederik\u00a0P Kingma, Abhishek Kumar, Stefano Ermon, and Ben Poole.\n\n</span>\n<span class=\"ltx_bibblock\">Score-based generative modeling through stochastic differential equations.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2011.13456</em>, 2020b.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib44\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Song et\u00a0al. (2021)</span>\n<span class=\"ltx_bibblock\">\nYang Song, Conor Durkan, Iain Murray, and Stefano Ermon.\n\n</span>\n<span class=\"ltx_bibblock\">Maximum likelihood training of score-based diffusion models.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">Advances in Neural Information Processing Systems</em>, volume\u00a034, pp.  1415\u20131428, 2021.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib45\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Wallace et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nBram Wallace, Meihua Dang, Rafael Rafailov, Linqi Zhou, Aaron Lou, Senthil Purushwalkam, Stefano Ermon, Caiming Xiong, Shafiq Joty, and Nikhil Naik.\n\n</span>\n<span class=\"ltx_bibblock\">Diffusion model alignment using direct preference optimization.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  8228\u20138238, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib46\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Wang et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nYibin Wang, Yuhang Zang, Hao Li, Cheng Jin, and Jiaqi Wang.\n\n</span>\n<span class=\"ltx_bibblock\">Unified reward model for multimodal understanding and generation.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2503.05236</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib47\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Wu et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nXiaoshi Wu, Keqiang Sun, Feng Zhu, Rui Zhao, and Hongsheng Li.\n\n</span>\n<span class=\"ltx_bibblock\">Human preference score: Better aligning text-to-image models with human preference.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  2096\u20132105, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib48\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Xiong et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nWei Xiong, Jiarui Yao, Yuhui Xu, Bo\u00a0Pang, Lei Wang, Doyen Sahoo, Junnan Li, Nan Jiang, Tong Zhang, Caiming Xiong, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">A minimalist approach to llm reasoning: from rejection sampling to reinforce.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2504.11343</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib49\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Xu et\u00a0al. (2023)</span>\n<span class=\"ltx_bibblock\">\nJiazheng Xu, Xiao Liu, Yuchen Wu, Yuxuan Tong, Qinkai Li, Ming Ding, Jie Tang, and Yuxiao Dong.\n\n</span>\n<span class=\"ltx_bibblock\">Imagereward: Learning and evaluating human preferences for text-to-image generation.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in Neural Information Processing Systems</em>, 36:15903\u201315935, 2023.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib50\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Xue et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nZeyue Xue, Jie Wu, Yu\u00a0Gao, Fangyuan Kong, Lingting Zhu, Mengzhao Chen, Zhiheng Liu, Wei Liu, Qiushan Guo, Weilin Huang, et\u00a0al.\n\n</span>\n<span class=\"ltx_bibblock\">Dancegrpo: Unleashing grpo on visual generation.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2505.07818</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib51\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Yang et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nKai Yang, Jian Tao, Jiafei Lyu, Chunjiang Ge, Jiaxin Chen, Weihan Shen, Xiaolong Zhu, and Xiu Li.\n\n</span>\n<span class=\"ltx_bibblock\">Using human feedback to fine-tune diffusion models without any reward model.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  8941\u20138951, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib52\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Yuan et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nHuizhuo Yuan, Zixiang Chen, Kaixuan Ji, and Quanquan Gu.\n\n</span>\n<span class=\"ltx_bibblock\">Self-play fine-tuning of diffusion models for text-to-image generation.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">Advances in Neural Information Processing Systems</em>, 37:73366\u201373398, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib53\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Zhang &amp; Chen (2022)</span>\n<span class=\"ltx_bibblock\">\nQinsheng Zhang and Yongxin Chen.\n\n</span>\n<span class=\"ltx_bibblock\">Fast sampling of diffusion models with exponential integrator.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2204.13902</em>, 2022.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib54\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Zheng et\u00a0al. (2023a)</span>\n<span class=\"ltx_bibblock\">\nKaiwen Zheng, Cheng Lu, Jianfei Chen, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Dpm-solver-v3: Improved diffusion ode solver with empirical model statistics.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023a.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib55\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Zheng et\u00a0al. (2023b)</span>\n<span class=\"ltx_bibblock\">\nKaiwen Zheng, Cheng Lu, Jianfei Chen, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Improved techniques for maximum likelihood estimation for diffusion odes.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">International Conference on Machine Learning</em>, pp.  42363\u201342389. PMLR, 2023b.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib56\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Zheng et\u00a0al. (2024)</span>\n<span class=\"ltx_bibblock\">\nKaiwen Zheng, Guande He, Jianfei Chen, Fan Bao, and Jun Zhu.\n\n</span>\n<span class=\"ltx_bibblock\">Diffusion bridge implicit models.\n\n</span>\n<span class=\"ltx_bibblock\"><em class=\"ltx_emph ltx_font_italic\">arXiv preprint arXiv:2405.15885</em>, 2024.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib57\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Zheng et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nKaiwen Zheng, Yongxin Chen, Huayu Chen, Guande He, Ming-Yu Liu, Jun Zhu, and Qinsheng Zhang.\n\n</span>\n<span class=\"ltx_bibblock\">Direct discriminative optimization: Your likelihood-based visual generative model is secretly a gan discriminator.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">ICML</em>, 2025.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib58\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Zhu et\u00a0al. (2025)</span>\n<span class=\"ltx_bibblock\">\nHuaisheng Zhu, Teng Xiao, and Vasant\u00a0G Honavar.\n\n</span>\n<span class=\"ltx_bibblock\">Dspo: Direct score preference optimization for diffusion model alignment.\n\n</span>\n<span class=\"ltx_bibblock\">In <em class=\"ltx_emph ltx_font_italic\">The Thirteenth International Conference on Learning Representations</em>, 2025.\n\n</span>\n</li>\n</ul>\n</section>\n<div class=\"ltx_pagination ltx_role_newpage\"></div>\n<div class=\"ltx_pagination ltx_role_newpage\"></div>\n<section class=\"ltx_appendix\" id=\"A1\">\n<h2 class=\"ltx_title ltx_title_appendix\" id=\"appendix-a-proof-of-theorems\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix A </span>Proof of Theorems</h2>\n<div class=\"ltx_theorem ltx_theorem_lemma\" id=\"A1.Thmtheorem1\">\n<h6 class=\"ltx_title ltx_runin ltx_title_theorem\" id=\"lemma-a1-distribution-split\">\n<span class=\"ltx_tag ltx_tag_theorem\"><span class=\"ltx_text ltx_font_bold\">Lemma A.1</span></span><span class=\"ltx_text ltx_font_bold\"> </span>(<span class=\"ltx_text ltx_font_bold\">Distribution Split</span>)<span class=\"ltx_text ltx_font_bold\">.</span>\n</h6>\n<div class=\"ltx_para\" id=\"A1.Thmtheorem1.p1\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.E7\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=1,{\\bm{c}})=\\frac{p(\\mathbf{o}=1|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}=\\frac{r({\\bm{x}}_{0},{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.E7.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03c0</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc28</mi></mrow><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=1,{\\bm{c}})=\\frac{p(\\mathbf{o}=1|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}=\\frac{r({\\bm{x}}_{0},{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(7)</span></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.E8\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{-}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=0,{\\bm{c}})=\\frac{p(\\mathbf{o}=0|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=0|{\\bm{c}})}=\\frac{1-r({\\bm{x}}_{0},{\\bm{c}})}{1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.E8.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03c0</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc28</mi></mrow><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>0</mn><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><mn>1</mn><mo>\u2212</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{-}({\\bm{x}}_{0}|{\\bm{c}}):=\\pi^{\\text{old}}({\\bm{x}}_{0}|\\mathbf{o}=0,{\\bm{c}})=\\frac{p(\\mathbf{o}=0|{\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}{p_{\\pi^{\\text{old}}}(\\mathbf{o}=0|{\\bm{c}})}=\\frac{1-r({\\bm{x}}_{0},{\\bm{c}})}{1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})}\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(8)</span></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.E9\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}})+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\pi^{-}({\\bm{x}}_{0}|{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.E9.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}})+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\pi^{-}({\\bm{x}}_{0}|{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(9)</span></td>\n</tr></tbody>\n</table>\n</div>\n</div>\n<div class=\"ltx_proof\">\n<h6 class=\"ltx_title ltx_runin ltx_font_italic ltx_title_proof\" id=\"proof\">Proof.</h6>\n<div class=\"ltx_para\" id=\"A1.p1\">\n\n</div>\n</div>\n<div class=\"ltx_theorem ltx_theorem_lemma\" id=\"A1.Thmtheorem2\">\n<h6 class=\"ltx_title ltx_runin ltx_title_theorem\" id=\"lemma-a2-posterior-split\">\n<span class=\"ltx_tag ltx_tag_theorem\"><span class=\"ltx_text ltx_font_bold\">Lemma A.2</span></span><span class=\"ltx_text ltx_font_bold\"> </span>(<span class=\"ltx_text ltx_font_bold\">Posterior Split</span>)<span class=\"ltx_text ltx_font_bold\">.</span>\n</h6>\n<div class=\"ltx_para\" id=\"A1.Thmtheorem2.p1\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex13\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=\\alpha({\\bm{x}}_{t})\\pi^{+}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})+[1-\\alpha({\\bm{x}}_{t})]\\pi^{-}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex13.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\u03c0</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=\\alpha({\\bm{x}}_{t})\\pi^{+}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})+[1-\\alpha({\\bm{x}}_{t})]\\pi^{-}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex14\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\text{where}\\quad\\quad\\alpha({\\bm{x}}_{t}):=\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex14.m1\" intent=\":literal\"><semantics><mrow><mrow><mtext class=\"ltx_mathvariant_italic\">where</mtext><mspace style=\"width:2em;\" width=\"2em\"></mspace><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>:=</mo><mrow><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{where}\\quad\\quad\\alpha({\\bm{x}}_{t}):=\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</div>\n<div class=\"ltx_proof\">\n<h6 class=\"ltx_title ltx_runin ltx_font_italic ltx_title_proof\" id=\"proof\">Proof.</h6>\n<div class=\"ltx_para\" id=\"A1.p2\">\n<p class=\"ltx_p\">Leveraging Bayes\u2019 Rule:</p>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex15\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})=\\frac{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex15.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03c0</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})=\\frac{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equationgroup ltx_eqn_table table table-responsive\" id=\"A1.Ex16\">\n<tbody id=\"A1.Ex16X\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\frac{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex16X.m2\" intent=\":literal\"><semantics><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03c0</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>=</mo><mi></mi></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\frac{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex16X.m3\" intent=\":literal\"><semantics><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03c0</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex16Xa\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\frac{\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex16Xa.m2\" intent=\":literal\"><semantics><mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03c0</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\frac{\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}{\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex16Xb\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\Rightarrow\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex16Xb.m2\" intent=\":literal\"><semantics><mrow><mi></mi><mo stretchy=\"false\">\u21d2</mo><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi></mi></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\Rightarrow\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex16Xb.m3\" intent=\":literal\"><semantics><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex16Xc\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\frac{\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex16Xc.m2\" intent=\":literal\"><semantics><mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\frac{\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex17\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex17.m1\" intent=\":literal\"><semantics><mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mi>t</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex18\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\frac{\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}=1\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex18.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}+[1-p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})]\\frac{\\pi^{-}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}=1</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">Note that</p>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex19\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})=\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex19.m1\" intent=\":literal\"><semantics><mrow><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})=\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">We have</p>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex20\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=\\alpha({\\bm{x}}_{t})\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})+[1-\\alpha({\\bm{x}}_{t})]\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex20.m1\" intent=\":literal\"><semantics><mrow><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=\\alpha({\\bm{x}}_{t})\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})+[1-\\alpha({\\bm{x}}_{t})]\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">\u220e</p>\n</div>\n</div>\n<div class=\"ltx_theorem ltx_theorem_theorem\" id=\"A1.Thmtheorem3\">\n<h6 class=\"ltx_title ltx_runin ltx_title_theorem\" id=\"theorem-a3-improvement-direction\">\n<span class=\"ltx_tag ltx_tag_theorem\"><span class=\"ltx_text ltx_font_bold\">Theorem A.3</span></span><span class=\"ltx_text ltx_font_bold\"> </span>(<span class=\"ltx_text ltx_font_bold\">Improvement Direction</span>)<span class=\"ltx_text ltx_font_bold\">.</span>\n</h6>\n<div class=\"ltx_para\" id=\"A1.Thmtheorem3.p1\">\n\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx2\">\n<tbody id=\"A1.Ex21\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\Delta:=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex21.m1\" intent=\":literal\"><semantics><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>:=</mo><mi></mi></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\Delta:=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle[1-\\alpha({\\bm{x}}_{t})]\\;[{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)]\\quad\\text{(Reinforcement Guidance)}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex21.m2\" intent=\":literal\"><semantics><mrow><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0.280em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mspace style=\"width:1em;\" width=\"1em\"></mspace><mtext class=\"ltx_mathvariant_italic\">(Reinforcement Guidance)</mtext></mrow><annotation encoding=\"application/x-tex\">\\displaystyle[1-\\alpha({\\bm{x}}_{t})]\\;[{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)]\\quad\\text{(Reinforcement Guidance)}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex22\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex22.m1\" intent=\":literal\"><semantics><mo>=</mo><annotation encoding=\"application/x-tex\">\\displaystyle=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\quad\\alpha({\\bm{x}}_{t})\\quad\\;\\;[{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)].\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex22.m2\" intent=\":literal\"><semantics><mrow><mrow><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mspace style=\"width:1.55555555555556em;\" width=\"1.55555555555556em\"></mspace><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msup><mi>\ud835\udc97</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\quad\\alpha({\\bm{x}}_{t})\\quad\\;\\;[{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)].</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex23\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\alpha({\\bm{x}}_{t}):=\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex23.m1\" intent=\":literal\"><semantics><mrow><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\alpha({\\bm{x}}_{t}):=\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</div>\n<div class=\"ltx_proof\">\n<h6 class=\"ltx_title ltx_runin ltx_font_italic ltx_title_proof\" id=\"proof\">Proof.</h6>\n<div class=\"ltx_para\" id=\"A1.p3\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex24\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)=a_{t}{\\bm{x}}_{t}+b_{t}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{x}}_{0}]\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex24.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>a</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>+</mo><mrow><msub><mi>b</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)=a_{t}{\\bm{x}}_{t}+b_{t}\\mathbb{E}_{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{x}}_{0}]</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex25\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)=a_{t}{\\bm{x}}_{t}+b_{t}\\mathbb{E}_{\\pi^{+}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{x}}_{0}]\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex25.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\ud835\udc97</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>a</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>+</mo><mrow><msub><mi>b</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)=a_{t}{\\bm{x}}_{t}+b_{t}\\mathbb{E}_{\\pi^{+}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{x}}_{0}]</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex26\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)=a_{t}{\\bm{x}}_{t}+b_{t}\\mathbb{E}_{\\pi^{=}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{x}}_{0}]\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex26.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\ud835\udc97</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>a</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>+</mo><mrow><msub><mi>b</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>\u03c0</mi><mo>=</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)=a_{t}{\\bm{x}}_{t}+b_{t}\\mathbb{E}_{\\pi^{=}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{x}}_{0}]</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex27\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)=\\alpha({\\bm{x}}_{t}){\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)+[1-\\alpha({\\bm{x}}_{t})]{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex27.m1\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)=\\alpha({\\bm{x}}_{t}){\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)+[1-\\alpha({\\bm{x}}_{t})]{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">Rearranging the equation, we complete the proof.\n\u220e</p>\n</div>\n</div>\n<div class=\"ltx_theorem ltx_theorem_theorem\" id=\"A1.Thmtheorem4\">\n<h6 class=\"ltx_title ltx_runin ltx_title_theorem\" id=\"theorem-a4-reinforcement-guidance-optimization\">\n<span class=\"ltx_tag ltx_tag_theorem\"><span class=\"ltx_text ltx_font_bold\">Theorem A.4</span></span><span class=\"ltx_text ltx_font_bold\"> </span>(<span class=\"ltx_text ltx_font_bold\">Reinforcement Guidance Optimization</span>)<span class=\"ltx_text ltx_font_bold\">.</span>\n</h6>\n<div class=\"ltx_para\" id=\"A1.Thmtheorem4.p1\">\n<p class=\"ltx_p\"><span class=\"ltx_text ltx_font_italic\">Consider the training objective:</span></p>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.E10\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathcal{L}(\\theta)=\\mathbb{E}_{{\\bm{c}},\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}}),t}\\;r\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+(1-r)\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2},\" class=\"ltx_Math\" display=\"block\" id=\"A1.E10.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mrow><msup><mi>\u03c0</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi>t</mi></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>r</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}(\\theta)=\\mathbb{E}_{{\\bm{c}},\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}}),t}\\;r\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+(1-r)\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2},</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(10)</span></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex28\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\quad\\quad\\text{where}\\quad{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t):=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t),\\quad\\text{(Implicit positive policy)}\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex28.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mtext class=\"ltx_mathvariant_italic\">where</mtext><mspace style=\"width:1em;\" width=\"1em\"></mspace><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>:=</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>\u03b2</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"1.167em\">,</mo><mtext class=\"ltx_mathvariant_italic\">(Implicit positive policy)</mtext></mrow><annotation encoding=\"application/x-tex\">\\quad\\quad\\text{where}\\quad{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t):=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t),\\quad\\text{(Implicit positive policy)}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex29\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\;\\;\\quad\\quad\\text{and}\\;\\;\\quad{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t):=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t).\\quad\\text{(Implicit negative policy)}\" class=\"ltx_math_unparsed\" display=\"block\" id=\"A1.Ex29.m1\" intent=\":literal\"><semantics><mrow><mtext class=\"ltx_mathvariant_italic\">and</mtext><mspace style=\"width:1.55555555555556em;\" width=\"1.55555555555556em\"></mspace><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>:=</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><mi>\u03b2</mi><mo stretchy=\"false\">)</mo></mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><mi>\u03b2</mi><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\">.</mo><mspace style=\"width:1.167em;\" width=\"1.167em\"></mspace><mtext class=\"ltx_mathvariant_italic\">(Implicit negative policy)</mtext></mrow><annotation encoding=\"application/x-tex\">\\;\\;\\quad\\quad\\text{and}\\;\\;\\quad{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t):=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t).\\quad\\text{(Implicit negative policy)}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A1.Ex30\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{v}}_{\\theta^{*}}({\\bm{x}}_{t},{\\bm{c}},t)={\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\frac{2}{\\beta}\\Delta({\\bm{x}}_{t},{\\bm{c}},t).\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex30.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msub><mi>\ud835\udc97</mi><msup><mi>\u03b8</mi><mo>\u2217</mo></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msup><mi>\ud835\udc97</mi><mtext class=\"ltx_mathvariant_italic\">old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>2</mn><mi>\u03b2</mi></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">\u0394</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\">{\\bm{v}}_{\\theta^{*}}({\\bm{x}}_{t},{\\bm{c}},t)={\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\frac{2}{\\beta}\\Delta({\\bm{x}}_{t},{\\bm{c}},t).</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</div>\n<div class=\"ltx_proof\">\n<h6 class=\"ltx_title ltx_runin ltx_font_italic ltx_title_proof\" id=\"proof\">Proof.</h6>\n<div class=\"ltx_para\" id=\"A1.p4\">\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx3\">\n<tbody id=\"A1.Ex31\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\mathcal{L}(\\theta)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex31.m1\" intent=\":literal\"><semantics><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\mathcal{L}(\\theta)</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}\\;r({\\bm{x}}_{0},{\\bm{c}})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+[1-r({\\bm{x}}_{0},{\\bm{c}})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex31.m2\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}\\;r({\\bm{x}}_{0},{\\bm{c}})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}+[1-r({\\bm{x}}_{0},{\\bm{c}})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex32\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=\\mathbb{E}_{{\\bm{c}}.t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\mathbb{E}_{\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex32.m1\" intent=\":literal\"><semantics><mrow><mo>=</mo><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo lspace=\"0em\" rspace=\"0.167em\">.</mo><mrow><mi>t</mi><mo>,</mo><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></msub><mrow><mo stretchy=\"false\">{</mo><msub><mi>\ud835\udd3c</mi><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mi>r</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi><msubsup><mo lspace=\"0em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=\\mathbb{E}_{{\\bm{c}}.t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\mathbb{E}_{\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}r({\\bm{x}}_{0},{\\bm{c}})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex33\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+\\mathbb{E}_{\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[1-r({\\bm{x}}_{0},{\\bm{c}})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex33.m1\" intent=\":literal\"><semantics><mrow><mo>+</mo><msub><mi>\ud835\udd3c</mi><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>\u2212</mo><mi>r</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi><msubsup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+\\mathbb{E}_{\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[1-r({\\bm{x}}_{0},{\\bm{c}})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx4\">\n<tbody id=\"A1.Ex34\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle r({\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex34.m1\" intent=\":literal\"><semantics><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle r({\\bm{x}}_{0},{\\bm{c}})\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=r({\\bm{x}}_{0},{\\bm{c}})\\frac{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex34.m2\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>\u03c0</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=r({\\bm{x}}_{0},{\\bm{c}})\\frac{\\pi^{\\text{old}}({\\bm{x}}_{0}|{\\bm{c}})\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex35\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\frac{\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}})\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex35.m1\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msup><mi>\u03c0</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>\u03c0</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\frac{\\pi^{+}({\\bm{x}}_{0}|{\\bm{c}})\\pi({\\bm{x}}_{t}|{\\bm{x}}_{0})}{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex36\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex36.m1\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><msub><mi>p</mi><msup><mi>\u03c0</mi><mtext>old</mtext></msup></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc28</mi><mo>=</mo><mrow><mn>1</mn><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=p_{\\pi^{\\text{old}}}(\\mathbf{o}=1|{\\bm{c}})\\frac{\\pi^{+}_{t}({\\bm{x}}_{t}|{\\bm{c}})}{\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex37\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=\\alpha({\\bm{x}}_{t})\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex37.m1\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=\\alpha({\\bm{x}}_{t})\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">Similarly,</p>\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx5\">\n<tbody id=\"A1.Ex39\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle[1-r({\\bm{x}}_{0},{\\bm{c}})]\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=[1-\\alpha({\\bm{x}}_{t})]\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex39.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>r</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo>,</mo><mi>\ud835\udc84</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle[1-r({\\bm{x}}_{0},{\\bm{c}})]\\pi^{\\text{old}}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})=[1-\\alpha({\\bm{x}}_{t})]\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">Then,</p>\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx6\">\n<tbody id=\"A1.Ex41\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\mathcal{L}(\\theta)=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex41.m1\" intent=\":literal\"><semantics><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi></mi></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\mathcal{L}(\\theta)=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\mathbb{E}_{\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex41.m2\" intent=\":literal\"><semantics><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><mo stretchy=\"false\">{</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><msub><mi>\ud835\udd3c</mi><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi><msubsup><mo lspace=\"0em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\mathbb{E}_{\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex42\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\mathbb{E}_{\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex42.m1\" intent=\":literal\"><semantics><mrow><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>\u2212</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><msub><mi>\ud835\udd3c</mi><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><mi>\ud835\udc97</mi><msubsup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\mathbb{E}_{\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}\\|_{2}^{2}\\}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex43\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex43.m1\" intent=\":literal\"><semantics><mo>=</mo><annotation encoding=\"application/x-tex\">\\displaystyle=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-\\mathbb{E}_{\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{v}}]\\|_{2}^{2}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex43.m2\" intent=\":literal\"><semantics><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><mo stretchy=\"false\">{</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><msub><mi>\ud835\udd3c</mi><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc97</mi><mo stretchy=\"false\">]</mo></mrow><msubsup><mo lspace=\"0em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-\\mathbb{E}_{\\pi^{+}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{v}}]\\|_{2}^{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex44\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-\\mathbb{E}_{\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{v}}]\\|_{2}^{2}\\}+C_{1}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex44.m1\" intent=\":literal\"><semantics><mrow><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>\u2212</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><msub><mi>\ud835\udd3c</mi><mrow><msubsup><mi>\u03c0</mi><mrow><mn>0</mn><mo fence=\"false\">|</mo><mi>t</mi></mrow><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mn>0</mn></msub><mo fence=\"false\">|</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc97</mi><mo stretchy=\"false\">]</mo></mrow><msubsup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy=\"false\">}</mo><mo>+</mo><mi>C</mi><msub><mi></mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-\\mathbb{E}_{\\pi^{-}_{0|t}({\\bm{x}}_{0}|{\\bm{x}}_{t},{\\bm{c}})}[{\\bm{v}}]\\|_{2}^{2}\\}+C_{1}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex45\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex45.m1\" intent=\":literal\"><semantics><mo>=</mo><annotation encoding=\"application/x-tex\">\\displaystyle=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)\\|_{2}^{2}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex45.m2\" intent=\":literal\"><semantics><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><mo stretchy=\"false\">{</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><msup><mi>\ud835\udc97</mi><mo>+</mo></msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><msubsup><mo lspace=\"0em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\|{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)\\|_{2}^{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex46\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)\\|_{2}^{2}\\}+C_{1}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex46.m1\" intent=\":literal\"><semantics><mrow><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>\u2212</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2212</mo><msup><mi>\ud835\udc97</mi><mo>\u2212</mo></msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><msubsup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy=\"false\">}</mo><mo>+</mo><mi>C</mi><msub><mi></mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\|{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)\\|_{2}^{2}\\}+C_{1}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx7\">\n<tbody id=\"A1.Ex47\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex47.m1\" intent=\":literal\"><semantics><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>+</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle{\\bm{v}}_{\\theta}^{+}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex47.m2\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>\u03b2</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mo>+</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=(1-\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)+\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{+}({\\bm{x}}_{t},{\\bm{c}},t)</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex48\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=\\beta[{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})}]\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex48.m1\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>\u2212</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=\\beta[{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})}]</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex49\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex49.m1\" intent=\":literal\"><semantics><mrow><mrow><msubsup><mi>\ud835\udc97</mi><mi>\u03b8</mi><mo>\u2212</mo></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle{\\bm{v}}_{\\theta}^{-}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex49.m2\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>+</mo><mi>\u03b2</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><msup><mi>\ud835\udc97</mi><mo>\u2212</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=(1+\\beta){\\bm{v}}^{\\text{old}}({\\bm{x}}_{t},{\\bm{c}},t)-\\beta{\\bm{v}}_{\\theta}({\\bm{x}}_{t},{\\bm{c}},t)-{\\bm{v}}^{-}({\\bm{x}}_{t},{\\bm{c}},t)</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex50\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=-\\beta[{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})}]\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex50.m1\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>\u2212</mo><mrow><mi>\u03b2</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>\u2212</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=-\\beta[{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})}]</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table table table-responsive\" id=\"A4.EGx8\">\n<tbody id=\"A1.Ex51\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\mathcal{L}(\\theta)=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex51.m1\" intent=\":literal\"><semantics><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi></mi></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\mathcal{L}(\\theta)=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\beta^{2}\\|{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})}\\|_{2}^{2}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex51.m2\" intent=\":literal\"><semantics><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><mo stretchy=\"false\">{</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><msup><mi>\u03b2</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>\u2212</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><msubsup><mo lspace=\"0em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\beta^{2}\\|{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})}\\|_{2}^{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex52\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\beta^{2}\\|{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})}\\|_{2}^{2}\\}+C_{1}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex52.m1\" intent=\":literal\"><semantics><mrow><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>\u2212</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><msup><mi>\u03b2</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>\u2212</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mstyle><msubsup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy=\"false\">}</mo><mo>+</mo><mi>C</mi><msub><mi></mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\beta^{2}\\|{\\bm{v}}_{\\theta}-{\\bm{v}}^{\\text{old}}-\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})}\\|_{2}^{2}\\}+C_{1}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex53\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex53.m1\" intent=\":literal\"><semantics><mo>=</mo><annotation encoding=\"application/x-tex\">\\displaystyle=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\beta^{2}\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\|{\\bm{v}}_{\\theta}-({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})})\\|_{2}^{2}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex53.m2\" intent=\":literal\"><semantics><mrow><msup><mi>\u03b2</mi><mn>2</mn></msup><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msubsup><mi>\u03c0</mi><mi>t</mi><mtext>old</mtext></msubsup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><mo stretchy=\"false\">{</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>+</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo stretchy=\"false\">)</mo></mrow><msubsup><mo lspace=\"0em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\beta^{2}\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}_{t}({\\bm{x}}_{t}|{\\bm{c}})}\\{\\alpha({\\bm{x}}_{t})\\|{\\bm{v}}_{\\theta}-({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})})\\|_{2}^{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex54\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\|{\\bm{v}}_{\\theta}-({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})})\\|_{2}^{2}\\}+C_{1}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"A1.Ex54.m1\" intent=\":literal\"><semantics><mrow><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>\u2212</mo><mi>\u03b1</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>+</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mstyle><mo stretchy=\"false\">)</mo></mrow><msubsup><mo lspace=\"0em\" rspace=\"0.167em\">\u2225</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy=\"false\">}</mo><mo>+</mo><mi>C</mi><msub><mi></mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\displaystyle+[1-\\alpha({\\bm{x}}_{t})]\\|{\\bm{v}}_{\\theta}-({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})})\\|_{2}^{2}\\}+C_{1}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex55\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex55.m1\" intent=\":literal\"><semantics><mo>=</mo><annotation encoding=\"application/x-tex\">\\displaystyle=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\beta^{2}\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}({\\bm{x}}_{t}|{\\bm{c}})}\\|{\\bm{v}}_{\\theta}-\\alpha({\\bm{x}}_{t})({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})})-[1-\\alpha({\\bm{x}}_{t})]({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})})\\|_{2}^{2}+C_{2}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex55.m2\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03b2</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>\u03b2</mi></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mstyle displaystyle=\"true\"><mfrac><mi mathvariant=\"normal\">\u0394</mi><mrow><mn>1</mn><mo>\u2212</mo><mrow><mi>\u03b1</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\beta^{2}\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}({\\bm{x}}_{t}|{\\bm{c}})}\\|{\\bm{v}}_{\\theta}-\\alpha({\\bm{x}}_{t})({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{\\alpha({\\bm{x}}_{t})})-[1-\\alpha({\\bm{x}}_{t})]({\\bm{v}}^{\\text{old}}+\\frac{1}{\\beta}\\frac{\\Delta}{1-\\alpha({\\bm{x}}_{t})})\\|_{2}^{2}+C_{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"A1.Ex56\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle=\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex56.m1\" intent=\":literal\"><semantics><mo>=</mo><annotation encoding=\"application/x-tex\">\\displaystyle=</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\beta^{2}\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}({\\bm{x}}_{t}|{\\bm{c}})}\\|{\\bm{v}}_{\\theta}-({\\bm{v}}^{\\text{old}}+\\frac{2}{\\beta}\\Delta)\\|_{2}^{2}+C_{2}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.Ex56.m2\" intent=\":literal\"><semantics><mrow><mrow><msup><mi>\u03b2</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udd3c</mi><mrow><mi>\ud835\udc84</mi><mo>,</mo><mi>t</mi><mo>,</mo><mrow><msup><mi>\u03c0</mi><mtext>old</mtext></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo fence=\"false\">|</mo><mi>\ud835\udc84</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo>\u2212</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udc97</mi><mtext>old</mtext></msup><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>2</mn><mi>\u03b2</mi></mfrac></mstyle><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">\u0394</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\beta^{2}\\mathbb{E}_{{\\bm{c}},t,\\pi^{\\text{old}}({\\bm{x}}_{t}|{\\bm{c}})}\\|{\\bm{v}}_{\\theta}-({\\bm{v}}^{\\text{old}}+\\frac{2}{\\beta}\\Delta)\\|_{2}^{2}+C_{2}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n\n</div>\n</div>\n</section>\n<section class=\"ltx_appendix\" id=\"A2\">\n<h2 class=\"ltx_title ltx_title_appendix\" id=\"appendix-b-theoretical-discussions\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix B </span>Theoretical Discussions</h2>\n<section class=\"ltx_subsection\" id=\"A2.SS1\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"b1-flow-sde\">\n<span class=\"ltx_tag ltx_tag_subsection\">B.1 </span>Flow SDE</h3>\n<div class=\"ltx_para ltx_noindent\" id=\"A2.SS1.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"A2.SS1.p2\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E11\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"f(t)=-\\frac{1}{1-t},\\quad g^{2}(t)=\\frac{2t}{1-t}\" class=\"ltx_Math\" display=\"block\" id=\"A2.E11.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mi>f</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>\u2212</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow></mfrac></mrow></mrow><mo rspace=\"1.167em\">,</mo><mrow><mrow><msup><mi>g</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow></mfrac></mrow></mrow><annotation encoding=\"application/x-tex\">f(t)=-\\frac{1}{1-t},\\quad g^{2}(t)=\\frac{2t}{1-t}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(11)</span></td>\n</tr></tbody>\n</table>\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"A2.SS1.p3\">\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E12\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathrm{d}{\\bm{x}}_{t}=\\left[f(t){\\bm{x}}_{t}-\\frac{1+\\lambda_{t}^{2}}{2}g^{2}(t)\\nabla_{{\\bm{x}}_{t}}\\log\\pi_{t}({\\bm{x}}_{t})\\right]\\mathrm{d}t+\\lambda_{t}g(t)\\mathrm{d}\\bar{{\\bm{w}}}_{t}\" class=\"ltx_Math\" display=\"block\" id=\"A2.E12.m1\" intent=\":literal\"><semantics><mrow><mrow><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>=</mo><mrow><mrow><mrow><mo>[</mo><mrow><mrow><mi>f</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>\u2212</mo><mrow><mfrac><mrow><mn>1</mn><mo>+</mo><msubsup><mi>\u03bb</mi><mi>t</mi><mn>2</mn></msubsup></mrow><mn>2</mn></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>g</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0.167em\" rspace=\"0em\">\u200b</mo><mrow><mrow><msub><mo rspace=\"0.167em\">\u2207</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></msub><mi>log</mi></mrow><mo lspace=\"0.167em\">\u2061</mo><msub><mi>\u03c0</mi><mi>t</mi></msub></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow><mo>+</mo><mrow><msub><mi>\u03bb</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>g</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mover accent=\"true\"><mi>\ud835\udc98</mi><mo>\u00af</mo></mover><mi>t</mi></msub></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathrm{d}{\\bm{x}}_{t}=\\left[f(t){\\bm{x}}_{t}-\\frac{1+\\lambda_{t}^{2}}{2}g^{2}(t)\\nabla_{{\\bm{x}}_{t}}\\log\\pi_{t}({\\bm{x}}_{t})\\right]\\mathrm{d}t+\\lambda_{t}g(t)\\mathrm{d}\\bar{{\\bm{w}}}_{t}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(12)</span></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E13\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\bm{\\epsilon}_{\\theta}({\\bm{x}}_{t},t)=-\\sigma_{t}{\\bm{s}}_{\\theta}({\\bm{x}}_{t},t),\\quad{\\bm{x}}_{\\theta}({\\bm{x}}_{t},t)=\\frac{{\\bm{x}}_{t}-\\sigma_{t}\\bm{\\epsilon}_{\\theta}({\\bm{x}}_{t},t)}{\\alpha_{t}},\\quad{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)=\\dot{\\alpha}_{t}{\\bm{x}}_{\\theta}({\\bm{x}}_{t},t)+\\dot{\\sigma}_{t}\\bm{\\epsilon}_{\\theta}({\\bm{x}}_{t},t)\" class=\"ltx_Math\" display=\"block\" id=\"A2.E13.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msub><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>\u2212</mo><mrow><msub><mi>\u03c3</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc94</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"1.167em\">,</mo><mrow><mrow><mrow><msub><mi>\ud835\udc99</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>\u2212</mo><mrow><msub><mi>\u03c3</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><msub><mi>\u03b1</mi><mi>t</mi></msub></mfrac></mrow><mo rspace=\"1.167em\">,</mo><mrow><mrow><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mover accent=\"true\"><mi>\u03b1</mi><mo>\u02d9</mo></mover><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mover accent=\"true\"><mi>\u03c3</mi><mo>\u02d9</mo></mover><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\bm{\\epsilon}_{\\theta}({\\bm{x}}_{t},t)=-\\sigma_{t}{\\bm{s}}_{\\theta}({\\bm{x}}_{t},t),\\quad{\\bm{x}}_{\\theta}({\\bm{x}}_{t},t)=\\frac{{\\bm{x}}_{t}-\\sigma_{t}\\bm{\\epsilon}_{\\theta}({\\bm{x}}_{t},t)}{\\alpha_{t}},\\quad{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)=\\dot{\\alpha}_{t}{\\bm{x}}_{\\theta}({\\bm{x}}_{t},t)+\\dot{\\sigma}_{t}\\bm{\\epsilon}_{\\theta}({\\bm{x}}_{t},t)</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(13)</span></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">Applying these relations to the rectified flow schedule, we can derive:</p>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E14\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{s}}_{\\theta}({\\bm{x}}_{t},t)=-\\frac{{\\bm{x}}_{t}+(1-t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)}{t}\" class=\"ltx_Math\" display=\"block\" id=\"A2.E14.m1\" intent=\":literal\"><semantics><mrow><mrow><msub><mi>\ud835\udc94</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>\u2212</mo><mfrac><mrow><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mi>t</mi></mfrac></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{s}}_{\\theta}({\\bm{x}}_{t},t)=-\\frac{{\\bm{x}}_{t}+(1-t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)}{t}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(14)</span></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E15\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathrm{d}{\\bm{x}}_{t}=\\left[(1+\\lambda_{t}^{2}){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\frac{\\lambda_{t}^{2}}{1-t}{\\bm{x}}_{t}\\right]\\mathrm{d}t+\\lambda_{t}\\sqrt{\\frac{2t}{1-t}}\\mathrm{d}{\\bm{w}}\" class=\"ltx_Math\" display=\"block\" id=\"A2.E15.m1\" intent=\":literal\"><semantics><mrow><mrow><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>=</mo><mrow><mrow><mrow><mo>[</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>+</mo><msubsup><mi>\u03bb</mi><mi>t</mi><mn>2</mn></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><msubsup><mi>\u03bb</mi><mi>t</mi><mn>2</mn></msubsup><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow></mrow><mo>]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow><mo>+</mo><mrow><msub><mi>\u03bb</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msqrt><mfrac><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow></mfrac></msqrt><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi mathvariant=\"normal\">d</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>\ud835\udc98</mi></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathrm{d}{\\bm{x}}_{t}=\\left[(1+\\lambda_{t}^{2}){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\frac{\\lambda_{t}^{2}}{1-t}{\\bm{x}}_{t}\\right]\\mathrm{d}t+\\lambda_{t}\\sqrt{\\frac{2t}{1-t}}\\mathrm{d}{\\bm{w}}</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(15)</span></td>\n</tr></tbody>\n</table>\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"A2.SS1.p4\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E16\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{x}}_{s}=\\left[(1-s)+\\sqrt{s^{2}-\\rho_{t}^{2}}\\right]{\\bm{x}}_{t}-\\left[(1-s)t-\\sqrt{s^{2}-\\rho_{t}^{2}}(1-t)\\right]{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\rho_{t}\\bm{\\epsilon},\\quad\\bm{\\epsilon}\\sim{\\mathcal{N}}(\\bm{0},{\\mathbf{I}})\" class=\"ltx_Math\" display=\"block\" id=\"A2.E16.m1\" intent=\":literal\"><semantics><mrow><mrow><msub><mi>\ud835\udc99</mi><mi>s</mi></msub><mo>=</mo><mrow><mrow><mrow><mrow><mo>[</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><msqrt><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>\u2212</mo><msubsup><mi>\u03c1</mi><mi>t</mi><mn>2</mn></msubsup></mrow></msqrt></mrow><mo>]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>\u2212</mo><mrow><mrow><mo>[</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi>t</mi></mrow><mo>\u2212</mo><mrow><msqrt><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>\u2212</mo><msubsup><mi>\u03c1</mi><mi>t</mi><mn>2</mn></msubsup></mrow></msqrt><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>\u2212</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mi>\u03c1</mi><mi>t</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi></mrow></mrow></mrow><mo rspace=\"1.167em\">,</mo><mrow><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mo>\u223c</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mn>\ud835\udfce</mn><mo>,</mo><mi>\ud835\udc08</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{x}}_{s}=\\left[(1-s)+\\sqrt{s^{2}-\\rho_{t}^{2}}\\right]{\\bm{x}}_{t}-\\left[(1-s)t-\\sqrt{s^{2}-\\rho_{t}^{2}}(1-t)\\right]{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+\\rho_{t}\\bm{\\epsilon},\\quad\\bm{\\epsilon}\\sim{\\mathcal{N}}(\\bm{0},{\\mathbf{I}})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(16)</span></td>\n</tr></tbody>\n</table>\n\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"A2.SS2\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"b2-high-order-flow-ode-sampler\">\n<span class=\"ltx_tag ltx_tag_subsection\">B.2 </span>High-Order Flow ODE Sampler</h3>\n<div class=\"ltx_para ltx_noindent\" id=\"A2.SS2.p1\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E17\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{x}}_{t_{i}}=\\frac{\\sigma_{t_{i}}}{\\sigma_{t_{i-1}}}{\\bm{x}}_{t_{i-1}}-\\alpha_{t_{i}}(e^{-h_{i}}-1)\\left[\\left(1+\\frac{1}{2r_{i}}\\right){\\bm{x}}_{\\theta}({\\bm{x}}_{t_{i-1}},t_{i-1})-\\frac{1}{2r_{i}}{\\bm{x}}_{\\theta}({\\bm{x}}_{t_{i-2}},t_{i-2})\\right]\" class=\"ltx_Math\" display=\"block\" id=\"A2.E17.m1\" intent=\":literal\"><semantics><mrow><msub><mi>\ud835\udc99</mi><msub><mi>t</mi><mi>i</mi></msub></msub><mo>=</mo><mrow><mrow><mfrac><msub><mi>\u03c3</mi><msub><mi>t</mi><mi>i</mi></msub></msub><msub><mi>\u03c3</mi><msub><mi>t</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>1</mn></mrow></msub></msub></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><msub><mi>t</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>1</mn></mrow></msub></msub></mrow><mo>\u2212</mo><mrow><msub><mi>\u03b1</mi><msub><mi>t</mi><mi>i</mi></msub></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>e</mi><mrow><mo>\u2212</mo><msub><mi>h</mi><mi>i</mi></msub></mrow></msup><mo>\u2212</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo>[</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>r</mi><mi>i</mi></msub></mrow></mfrac></mrow><mo>)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><msub><mi>t</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>1</mn></mrow></msub></msub><mo>,</mo><msub><mi>t</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>r</mi><mi>i</mi></msub></mrow></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><msub><mi>t</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>2</mn></mrow></msub></msub><mo>,</mo><msub><mi>t</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>2</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{x}}_{t_{i}}=\\frac{\\sigma_{t_{i}}}{\\sigma_{t_{i-1}}}{\\bm{x}}_{t_{i-1}}-\\alpha_{t_{i}}(e^{-h_{i}}-1)\\left[\\left(1+\\frac{1}{2r_{i}}\\right){\\bm{x}}_{\\theta}({\\bm{x}}_{t_{i-1}},t_{i-1})-\\frac{1}{2r_{i}}{\\bm{x}}_{\\theta}({\\bm{x}}_{t_{i-2}},t_{i-2})\\right]</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(17)</span></td>\n</tr></tbody>\n</table>\n\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"A2.SS3\">\n<h3 class=\"ltx_title ltx_title_subsection\" id=\"b3-intuition-behind-the-flowgrpo-objective\">\n<span class=\"ltx_tag ltx_tag_subsection\">B.3 </span>Intuition behind the FlowGRPO Objective</h3>\n<div class=\"ltx_para ltx_noindent\" id=\"A2.SS3.p1\">\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E18\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"{\\bm{x}}_{s}=l(s,t){\\bm{x}}_{t}-m(s,t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+n(s,t)\\bm{\\epsilon},\\quad\\bm{\\epsilon}\\sim\\mathcal{N}(\\bf 0,\\mathbf{I})\" class=\"ltx_Math\" display=\"block\" id=\"A2.E18.m1\" intent=\":literal\"><semantics><mrow><mrow><msub><mi>\ud835\udc99</mi><mi>s</mi></msub><mo>=</mo><mrow><mrow><mrow><mi>l</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>\u2212</mo><mrow><mi>m</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>n</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi></mrow></mrow></mrow><mo rspace=\"1.167em\">,</mo><mrow><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mo>\u223c</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mn>\ud835\udfce</mn><mo>,</mo><mi>\ud835\udc08</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">{\\bm{x}}_{s}=l(s,t){\\bm{x}}_{t}-m(s,t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)+n(s,t)\\bm{\\epsilon},\\quad\\bm{\\epsilon}\\sim\\mathcal{N}(\\bf 0,\\mathbf{I})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(18)</span></td>\n</tr></tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E19\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathcal{L}(\\theta)=-\\frac{1}{N}\\sum_{i=1}^{N}A^{(i)}\\log p_{\\theta}({\\bm{x}}_{s}^{(i)}|{\\bm{x}}_{t})\" class=\"ltx_Math\" display=\"block\" id=\"A2.E19.m1\" intent=\":literal\"><semantics><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>\u2212</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><munderover><mo movablelimits=\"false\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><msup><mi>A</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo lspace=\"0.167em\" rspace=\"0em\">\u200b</mo><mrow><mi>log</mi><mo lspace=\"0.167em\">\u2061</mo><msub><mi>p</mi><mi>\u03b8</mi></msub></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>\ud835\udc99</mi><mi>s</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}(\\theta)=-\\frac{1}{N}\\sum_{i=1}^{N}A^{(i)}\\log p_{\\theta}({\\bm{x}}_{s}^{(i)}|{\\bm{x}}_{t})</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(19)</span></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">where</p>\n<table class=\"ltx_equationgroup ltx_eqn_table table table-responsive\" id=\"A2.E20\">\n<tbody>\n<tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\" id=\"A2.E20X\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\log p_{\\theta}({\\bm{x}}_{s}^{(i)}|{\\bm{x}}_{t})\" class=\"ltx_Math\" display=\"inline\" id=\"A2.E20X.m2\" intent=\":literal\"><semantics><mrow><mrow><mi>log</mi><mo lspace=\"0.167em\">\u2061</mo><msub><mi>p</mi><mi>\u03b8</mi></msub></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>\ud835\udc99</mi><mi>s</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\log p_{\\theta}({\\bm{x}}_{s}^{(i)}|{\\bm{x}}_{t})</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=-\\frac{\\|{\\bm{x}}_{s}^{(i)}-(l(s,t){\\bm{x}}_{t}-m(s,t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t))\\|_{2}^{2}}{2n^{2}(s,t)}+C\" class=\"ltx_Math\" display=\"inline\" id=\"A2.E20X.m3\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mo>\u2212</mo><mstyle displaystyle=\"true\"><mfrac><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><msubsup><mi>\ud835\udc99</mi><mi>s</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2212</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>l</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo>\u2212</mo><mrow><mi>m</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>n</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo>+</mo><mi>C</mi></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=-\\frac{\\|{\\bm{x}}_{s}^{(i)}-(l(s,t){\\bm{x}}_{t}-m(s,t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t))\\|_{2}^{2}}{2n^{2}(s,t)}+C</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"2\"><span class=\"ltx_tag ltx_tag_equationgroup ltx_align_right\">(20)</span></td>\n</tr>\n<tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\" id=\"A2.E20Xa\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_eqn_cell\"></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle=-\\frac{\\|m(s,t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)-m(s,t){\\bm{v}}_{\\texttt{sg}(\\theta)}({\\bm{x}}_{t},t)+n(s,t)\\bm{\\epsilon}^{(i)}\\|_{2}^{2}}{2n^{2}(s,t)}+C\" class=\"ltx_Math\" display=\"inline\" id=\"A2.E20Xa.m2\" intent=\":literal\"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mo>\u2212</mo><mstyle displaystyle=\"true\"><mfrac><msubsup><mrow><mo stretchy=\"false\">\u2016</mo><mrow><mrow><mrow><mi>m</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2212</mo><mrow><mi>m</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mrow><mtext class=\"ltx_mathvariant_monospace\">sg</mtext><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>n</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mrow><mo stretchy=\"false\">\u2016</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mrow><mn>2</mn><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi>n</mi><mn>2</mn></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo>+</mo><mi>C</mi></mrow></mrow><annotation encoding=\"application/x-tex\">\\displaystyle=-\\frac{\\|m(s,t){\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)-m(s,t){\\bm{v}}_{\\texttt{sg}(\\theta)}({\\bm{x}}_{t},t)+n(s,t)\\bm{\\epsilon}^{(i)}\\|_{2}^{2}}{2n^{2}(s,t)}+C</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr>\n</tbody>\n</table>\n\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E21\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\nabla_{\\theta}\\log p_{\\theta}({\\bm{x}}_{s}^{(i)}|{\\bm{x}}_{t})=-\\frac{m(s,t)}{n(s,t)}\\nabla_{\\theta}((\\bm{\\epsilon}^{(i)})^{\\top}{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t))\" class=\"ltx_Math\" display=\"block\" id=\"A2.E21.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><mrow><msub><mo>\u2207</mo><mi>\u03b8</mi></msub><mi>log</mi></mrow><mo lspace=\"0.167em\">\u2061</mo><msub><mi>p</mi><mi>\u03b8</mi></msub></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>\ud835\udc99</mi><mi>s</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo fence=\"false\">|</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>\u2212</mo><mrow><mfrac><mrow><mi>m</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>n</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo lspace=\"0.167em\" rspace=\"0em\">\u200b</mo><mrow><msub><mo>\u2207</mo><mi>\u03b8</mi></msub><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><msup><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u22a4</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\nabla_{\\theta}\\log p_{\\theta}({\\bm{x}}_{s}^{(i)}|{\\bm{x}}_{t})=-\\frac{m(s,t)}{n(s,t)}\\nabla_{\\theta}((\\bm{\\epsilon}^{(i)})^{\\top}{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t))</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(21)</span></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\">and</p>\n<table class=\"ltx_equation ltx_eqn_table table table-responsive\" id=\"A2.E22\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\nabla_{\\theta}\\mathcal{L}(\\theta)=\\frac{m(s,t)}{n(s,t)}\\nabla_{\\theta}\\left[\\frac{1}{N}\\sum_{i=1}^{N}(A^{(i)}\\bm{\\epsilon}^{(i)})^{\\top}{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)\\right]\" class=\"ltx_Math\" display=\"block\" id=\"A2.E22.m1\" intent=\":literal\"><semantics><mrow><mrow><mrow><msub><mo>\u2207</mo><mi>\u03b8</mi></msub><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi></mrow><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi>m</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>n</mi><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo lspace=\"0.167em\" rspace=\"0em\">\u200b</mo><mrow><msub><mo>\u2207</mo><mi>\u03b8</mi></msub><mrow><mo>[</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><munderover><mo movablelimits=\"false\" rspace=\"0em\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>A</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msup><mi class=\"ltx_mathvariant_bold-italic\" mathvariant=\"bold-italic\">\u03f5</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u22a4</mo></msup><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><msub><mi>\ud835\udc97</mi><mi>\u03b8</mi></msub><mo lspace=\"0em\" rspace=\"0em\">\u200b</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc99</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding=\"application/x-tex\">\\nabla_{\\theta}\\mathcal{L}(\\theta)=\\frac{m(s,t)}{n(s,t)}\\nabla_{\\theta}\\left[\\frac{1}{N}\\sum_{i=1}^{N}(A^{(i)}\\bm{\\epsilon}^{(i)})^{\\top}{\\bm{v}}_{\\theta}({\\bm{x}}_{t},t)\\right]</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(22)</span></td>\n</tr></tbody>\n</table>\n\n</div>\n</section>\n</section>\n<section class=\"ltx_appendix\" id=\"A3\">\n<h2 class=\"ltx_title ltx_title_appendix\" id=\"appendix-c-experiment-details\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix C </span>Experiment Details</h2>\n<div class=\"ltx_para ltx_noindent\" id=\"A3.p1\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"A3.p2\">\n\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"A3.p3\">\n\n</div>\n</section>\n<section class=\"ltx_appendix\" id=\"A4\">\n<h2 class=\"ltx_title ltx_title_appendix\" id=\"appendix-d-additional-results\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix D </span>Additional Results</h2>\n<div class=\"ltx_para ltx_noindent\" id=\"A4.p1\">\n\n</div>\n<figure class=\"ltx_figure\" id=\"A4.F11\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_portrait\" height=\"1148\" id=\"A4.F11.g1\" src=\"https://arxiv.org/html/x16.png\" width=\"830\"/>\n<br class=\"ltx_break ltx_centering\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 11: </span> Qualitative comparison between FlowGRPO and our model on GenEval prompts.</figcaption>\n</figure>\n<figure class=\"ltx_figure\" id=\"A4.F12\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_portrait\" height=\"1240\" id=\"A4.F12.g1\" src=\"https://arxiv.org/html/x17.png\" width=\"830\"/>\n<br class=\"ltx_break ltx_centering\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 12: </span> Qualitative comparison between FlowGRPO and our model on OCR prompts.</figcaption>\n</figure>\n<figure class=\"ltx_figure\" id=\"A4.F13\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_portrait\" height=\"1133\" id=\"A4.F13.g1\" src=\"https://arxiv.org/html/x18.png\" width=\"830\"/>\n<br class=\"ltx_break ltx_centering\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 13: </span> Qualitative comparison between FlowGRPO and our model on DrawBench prompts.</figcaption>\n</figure>\n</section>\n</article>\n</div>\n\n</div>",
    "sections": [
      {
        "id": "diffusionnft-online-diffusion-reinforcement-with-forward-process",
        "title": "DiffusionNFT: Online Diffusion Reinforcement with Forward Process",
        "level": 1
      },
      {
        "id": "abstract",
        "title": "Abstract",
        "level": 6
      },
      {
        "id": "1-introduction",
        "title": "1 Introduction",
        "level": 2
      },
      {
        "id": "2-background",
        "title": "2 Background",
        "level": 2
      },
      {
        "id": "21-diffusion-and-flow-models",
        "title": "2.1 Diffusion and Flow Models",
        "level": 3
      },
      {
        "id": "22-policy-gradient-algorithms-for-diffusion-models",
        "title": "2.2 Policy Gradient Algorithms for Diffusion Models",
        "level": 3
      },
      {
        "id": "3-diffusion-reinforcement-via-negative-aware-finetuning",
        "title": "3 Diffusion Reinforcement via Negative-aware Finetuning",
        "level": 2
      },
      {
        "id": "31-problem-setup",
        "title": "3.1 Problem Setup",
        "level": 3
      },
      {
        "id": "online-rl",
        "title": "Online RL.",
        "level": 5
      },
      {
        "id": "policy-improvement-on-positive-data",
        "title": "Policy Improvement on Positive Data.",
        "level": 5
      },
      {
        "id": "reinforcement-guidance",
        "title": "Reinforcement Guidance.",
        "level": 5
      },
      {
        "id": "32-negative-aware-diffusion-reinforcement-with-forward-process",
        "title": "3.2 Negative-aware Diffusion Reinforcement with Forward Process",
        "level": 3
      },
      {
        "id": "theorem-31-improvement-direction",
        "title": "Theorem 3.1 (Improvement Direction).",
        "level": 6
      },
      {
        "id": "theorem-32-policy-optimization",
        "title": "Theorem 3.2 (Policy Optimization).",
        "level": 6
      },
      {
        "id": "33-practical-implementation",
        "title": "3.3 Practical Implementation",
        "level": 3
      },
      {
        "id": "4-experiments",
        "title": "4 Experiments",
        "level": 2
      },
      {
        "id": "41-experimental-setup",
        "title": "4.1 Experimental Setup",
        "level": 3
      },
      {
        "id": "42-multi-reward-joint-training",
        "title": "4.2 Multi-Reward Joint Training",
        "level": 3
      },
      {
        "id": "43-head-to-head-comparison",
        "title": "4.3 Head-to-Head Comparison",
        "level": 3
      },
      {
        "id": "44-ablation-studies",
        "title": "4.4 Ablation Studies",
        "level": 3
      },
      {
        "id": "5-related-work",
        "title": "5 Related Work",
        "level": 2
      },
      {
        "id": "6-conclusion",
        "title": "6 Conclusion",
        "level": 2
      },
      {
        "id": "acknowledgments",
        "title": "Acknowledgments",
        "level": 4
      },
      {
        "id": "references",
        "title": "References",
        "level": 2
      },
      {
        "id": "appendix-a-proof-of-theorems",
        "title": "Appendix A Proof of Theorems",
        "level": 2
      },
      {
        "id": "lemma-a1-distribution-split",
        "title": "Lemma A.1 (Distribution Split).",
        "level": 6
      },
      {
        "id": "proof",
        "title": "Proof.",
        "level": 6
      },
      {
        "id": "lemma-a2-posterior-split",
        "title": "Lemma A.2 (Posterior Split).",
        "level": 6
      },
      {
        "id": "proof",
        "title": "Proof.",
        "level": 6
      },
      {
        "id": "theorem-a3-improvement-direction",
        "title": "Theorem A.3 (Improvement Direction).",
        "level": 6
      },
      {
        "id": "proof",
        "title": "Proof.",
        "level": 6
      },
      {
        "id": "theorem-a4-reinforcement-guidance-optimization",
        "title": "Theorem A.4 (Reinforcement Guidance Optimization).",
        "level": 6
      },
      {
        "id": "proof",
        "title": "Proof.",
        "level": 6
      },
      {
        "id": "appendix-b-theoretical-discussions",
        "title": "Appendix B Theoretical Discussions",
        "level": 2
      },
      {
        "id": "b1-flow-sde",
        "title": "B.1 Flow SDE",
        "level": 3
      },
      {
        "id": "b2-high-order-flow-ode-sampler",
        "title": "B.2 High-Order Flow ODE Sampler",
        "level": 3
      },
      {
        "id": "b3-intuition-behind-the-flowgrpo-objective",
        "title": "B.3 Intuition behind the FlowGRPO Objective",
        "level": 3
      },
      {
        "id": "appendix-c-experiment-details",
        "title": "Appendix C Experiment Details",
        "level": 2
      },
      {
        "id": "appendix-d-additional-results",
        "title": "Appendix D Additional Results",
        "level": 2
      }
    ],
    "has_math": true
  },
  "cached_at": 1758566972.262573
}